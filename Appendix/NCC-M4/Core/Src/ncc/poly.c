#include <stdint.h>
#include <stdlib.h>
#include "params.h"
#include "poly.h"
#include "reduce.h"
#include "rounding.h"
#include "symmetric.h"
#include <string.h>
#include <time.h>
#include "packing.h"
#include "./sign.h"
#include <stdio.h>


#ifdef DBENCH
#include "test/cpucycles.h"
extern const uint64_t timing_overhead;
extern uint64_t *tred, *tadd, *tmul, *tround, *tsample, *tpack;
#define DBENCH_START() uint64_t time = cpucycles()
#define DBENCH_STOP(t) t += cpucycles() - time - timing_overhead
#else
#define DBENCH_START()
#define DBENCH_STOP(t)
#endif

#if NIMS_TRI_NTT_MODE == 1
//N = 1152 = 2^7 * 3^2
//Q = 8401537
//zeta = 174396 //(2^7*3^3)th root of unity
//invMONT = 4009235
//invzeta = 6214534 
//W = zeta^(2^7 * 3^2) = 4804004
#define MONT 1781889 // 2^32 % Q

#define Wmont	1857311 //mont * W (W : 3rd root of unity)
#define W2mont	4762337 //mont * W^2
#define	F1	5143946 //mont^2/N
#define F2	1886355 //2 * mont^2/N

#define radix3_len 3 //radix-3 2번
#define radix2_redlen_ntt (N>>8)
#define radix2_redlen_invntt (N>>3)


int32_t merging_zetas[]= {3639200, 2686861, 6424568, 6554301, 7526435, 877607, 306698, 4659475, 3390155, 4282716, 2808328, 2116573, 5543577, 1552595, 3460077, 432998, 1424358, 6433532, 184706, 2775436, 5190529, 8309856, 5524170, 907034, 1179760, 1878681, 8184262, 2536834, 6481742, 4693847, 4814234, 180498, 3132507, 7290507, 4004427, 1957344, 6032763, 2486172, 1485307, 3001095, 1251, 347708, 7922675, 2440877, 7044727, 4274417, 3564940, 2831444, 1643646, 6469915, 8315960, 1758450, 7099282, 4932998, 3590231, 2162462, 4706816, 3277849, 1524716, 4050420, 7601909, 7594467, 5145204, 7823061, 3264673, 959142, 33147, 8348313, 5706219, 5641511, 5056889, 7716605, 2768240, 3125966, 662643, 6249357, 4070954, 7628050, 4602216, 5394914, 35121, 74136, 1732710, 2427534, 7254923, 1054835, 128776, 6297943, 8089830, 418975, 6436867, 1595450, 5925628, 6136950, 7283296, 6663782, 1962506, 5691488, 5391729, 5785737, 5642710, 5281972, 2650439, 6112046, 821034, 6317452, 88822, 4418807, 4770462, 6502665, 2888434, 3205705, 4068162, 1652755, 966215, 3845994, 7352241, 989379, 801959, 6977760, 3823033, 8233299, 4378563, 814504, 7392628, 3440373, 1721};
int32_t merging_zetas_radix3[] = {166697, 6845588, 6665025, 1055950, 5397364, 7983055, 8357888, 3421184, 3919256, 3438345, 4410150, 4092812, 1416683, 7195496, 5728828, 6185265, 3723422, 1882396, 7779633, 2216272, 869976, 7513996, 5677537, 7345587, 3547575, 1555949, 7289392, 8251446, 7040902, 5766783, 7670156, 4308725, 6400991, 3281506, 6768989, 6272686, 5312884, 1804128, 4912184, 5236045, 2809088, 1173945, 1525494, 5379350, 7224001, 5838419, 8032750, 4157775, 1253810, 4455451, 6366809, 4243762, 1463651, 2213858, 1286086, 2128851, 3989177, 5120031, 1998401, 3709568, 350843, 5961903, 5982363, 3022187, 2762523, 2497947, 1729880, 1444848, 2867333, 2520659, 8114824, 8176527, 5640971, 5241189, 5619998, 7414630, 5451998, 8157324, 891074, 3019018, 259380, 7739136, 2884256, 5382519, 1623184, 7189620, 1780643, 6956689, 5659819, 5903590, 2037329, 1200635, 5795677, 5539677, 6705351, 986907, 8164013, 4626509, 5544997, 7293981, 7269149, 822304, 1272183, 6331963, 5067109, 5700756, 8248400, 7784199, 2850064, 6730950, 5995097, 7818575, 4870071, 1925728, 6785547, 582962, 1610847, 5714625, 1972010, 1107556, 1335085, 3775028, 3988549, 5623394, 6186475, 239342, 4137664, 617338, 6000207, 3986235, 6427198, 1761884, 7442507, 4347876, 146701, 4587787, 6301921, 5153193, 2338904, 325165, 4336178, 2939034, 7937225, 1332138, 2235158, 737891, 1822626, 7069399, 544749, 4912952, 1389189, 6639653, 8223422, 4415302, 7387824, 4700918, 7389544, 5680014, 7364226, 8076372, 3844299, 2372245, 5700908, 2689186, 3381791, 7807571, 1186891, 6253391, 8227131, 1203793, 8398078, 3810723, 3050069, 1689658, 4760685, 7372983, 7548598, 3576038, 7110541, 1028554, 7749009, 1662577, 461062, 5712351, 7192649, 6029292, 3916284, 4378844, 4563661, 6779017, 104652, 4590814, 7355171, 4185321, 4911153, 8388112, 2257957, 4238909, 750546, 5876447, 1311251, 924531, 2837347, 2591074, 7364365, 4845849, 3895548, 6395666, 2222840, 5109852, 1272944, 2005871, 97634, 65984, 301773, 13425, 4514923, 4216216, 116406, 4832424, 2604530, 2233038, 1618071, 5810463, 8025058, 6796594, 3682449, 7366625, 336813, 2140402, 2378882, 6161882, 273132, 5125424, 6856111, 3080743, 259546, 5753620, 7726772, 1461437, 7441504, 3520481, 694493, 6940100, 5320068, 841088, 7229206, 1034912, 3600911, 1604943, 4902281, 4718708, 5084858, 3601839, 6490674, 5320794, 6786372, 5073513, 1560222, 3366627, 6673736, 1387431, 5435217, 1456875, 3965136, 7052183, 4973489, 6802716, 676078, 3189565, 1048441, 7520903, 130820, 3724159, 7208192, 880634, 3156148, 8259591, 5084688, 5034910, 8163426, 3328024, 2426084, 6556192, 3834447, 506797, 6168821, 1598821, 4794542, 3390860, 7425926, 3334575, 3057769, 2283912, 348882, 1539320, 5221396, 6921825, 494139, 5867745, 7702617, 221956, 4621787, 2350794, 4607652, 1911148, 3870025, 6050743, 4531429, 7407065, 5033868, 5066962, 6576914, 5010677, 1645681, 3556531, 1048954, 4634706, 3492407, 2533792, 514029, 3935336, 4090292, 2867599, 6066303, 375767, 3522876, 4806010, 1328031, 4486445, 2911167, 8130447, 8036213, 7256718, 4127023, 6726637, 3824161, 20244, 4931633, 1674900, 1565727, 4534920, 1659243, 5533938, 471459, 4466201, 7030537, 1722780, 2986958, 7102404, 7086664, 271090, 5324318, 5560875, 6661532, 8251647, 1433627, 4659462, 6534493, 2206251, 7777014, 6127693, 7579864, 545577, 7298144, 6773636, 8123459, 1882877, 7613357, 3287031, 8069214, 6518660, 1169641, 2751828, 631538, 149890, 837334, 2840662, 1554066, 6623746, 3911736, 6542339, 4865068, 7855960, 913651, 4403202, 5971606, 7552197, 1214256, 4675293, 5494430, 4274332, 2603493, 5034447, 4724383, 7031319, 5691014, 7292838, 3937736, 3357277, 126705, 1036112, 334192, 5044260, 1372155, 2904114, 3492578, 849340, 97875, 3998335, 6397371, 6443498, 1932093, 8032570, 1952112, 1370218, 433968, 1504803, 5732876, 2529673, 332153, 776340, 5769014, 5623332, 1846049, 2324173, 2209806, 5465102, 5787086, 4789376, 2758040, 5774153, 2922670, 3828976, 7029097, 2627384, 7892769, 2686897, 4988024, 5871864, 7083542, 6896734, 6915676, 7319049, 6758531, 6550493, 718978, 2936435, 7639038, 5784777, 905530, 7690598, 6502344, 8009749, 4402068, 317038, 4320431, 252265, 6911650, 3694781, 6016716, 5415336, 452555, 3207273, 1995241, 6037042, 7753405, 5194264, 7352045, 4011819, 7593818, 710939, 2207645, 2616760, 1837278, 4704397, 5448151, 2815485, 5939777, 4706756, 1674074, 2786635, 5300999, 243836, 4940590, 1565819, 7871804, 56413, 6194638, 5032277, 5492095, 44944, 877240, 4823119, 8188766, 2207844, 8028620, 7818912, 2102600, 6193693, 311750, 101357, 8013418, 8157701, 6609610, 5614902, 5728214, 5066955, 1827084, 3773663, 7376204, 8356593, 1672121, 5236652, 7402811, 3550421, 6279939, 5065101, 1667742, 1071664, 88165, 6884768, 868824, 6227003, 6241571, 7572800, 5983894, 7163505, 730565, 3719883, 2613809, 1238032, 2194640, 7298667, 1106173, 4851116, 5051056, 3164885, 5052715, 2721684, 7540196, 3827069, 6358048, 2174534, 5366704, 6982292, 2000622, 2002206, 386535, 5459951, 3151447, 7084159, 2280675, 7058482, 5680212, 5912141, 1029201, 5179930, 8364935, 2725193, 6838596, 5639237, 6237576, 5676344, 5212315, 4594763, 110922, 6399331, 1624362, 1419245, 6154074, 7182136, 4350830, 8185144, 4439090, 2489396, 4965202, 8038247, 6732205, 1930591, 6753105, 4241250, 779309, 6020930, 1128088, 4667850, 5349334, 6917451, 6231802, 972083, 3167615, 2910987, 3278486, 4304560, 6712821, 5490550, 4224895, 4536844, 8002439, 6470946, 5814750, 363290, 4038844, 2902674, 8034990, 7152237, 422949, 1484086, 7433838, 6240075, 5775104, 8368151, 7486873, 5486853, 99336, 5216654, 35252, 5924414, 5161793, 3598049, 5797824, 7265323, 3830902, 7598667, 4768038, 3762952, 8170391, 802870, 2405954, 413166, 125372, 33386, 5166111, 2161462, 1794968, 7231937, 4605560, 4683983, 2154908, 4803488, 5215641, 4042892, 4949988, 3365037, 7792083, 1870695, 2738253, 31351, 2836346, 1013632, 2169683, 3993044, 6367918, 1820338, 6361249, 4589212, 7643252, 5056524, 521183, 3812325, 1521152, 4024395, 1094223, 5036500, 693331, 4358645, 5198194, 5185375, 6893471, 6459907, 6938845, 4408493, 4663564, 5484672, 7186745, 2752032, 7486996, 6048222, 3233448, 7000252, 2565047, 6782582, 3815064, 6617490, 387443, 4892947, 6615927, 355439, 4698106, 3865717, 1253114, 8046098, 3417988, 5216205, 2207387, 5649505, 3748470, 2916865, 6402334, 7644979, 4213423, 6403661, 316844, 1784047, 1084779, 6228893, 4142843, 3392613, 3309611, 51966, 295518, 120838, 3574146, 6979264, 5265114, 6244362, 5517655, 1599226, 8316386, 1601446, 5502127, 4806620, 2896051, 6800091, 326103, 6365200, 2634223, 5008924, 2032195, 2172644, 5678895, 4991839, 667587, 1653412, 7845810, 2157175, 1082847, 2591025, 5383208, 8131423, 2978262, 4011609, 258976, 6005912, 5934871, 5723287, 3063667, 1064785, 2274526, 5456268, 3271346, 4050356, 7768152, 8314312, 1675551, 4351181, 1097736, 7070697, 4083424, 270114, 8349902, 5810512, 5519289, 5186154, 2411258, 8061965, 2079298, 7336752, 5525650, 6692897, 2746890, 15659, 6947179, 883906, 4155353, 892614, 5969160, 5057514, 5130846, 5562656, 5970049, 6937875, 270021, 8333695, 2349929, 3348874, 438319, 67842, 318122, 6455270, 5418701, 8385878, 1012578, 1708640, 3788125, 6953534, 1047748, 816064, 3295236, 2838881, 2857261, 2377575, 4154298, 7052845, 7488303, 3191435, 2520594, 8379212, 7805834, 7061874, 6785910, 3791820, 5327580, 745503, 1100786, 4089772, 7920304, 1037912, 8281822, 4311765, 8161022, 3769495, 560710, 1348692, 5198125, 6023962, 5702415, 7798348, 7355223, 7281207, 2916424, 4609717, 146560, 4014599, 1633202, 525574, 1105642, 2359345, 1641973, 1787803, 967589, 1394046, 7001742, 7874901, 821968, 4494445, 7595588, 7690642, 5559678, 5408645, 5571547, 710895, 3459109, 1261167, 6359710, 7875963, 7945891, 4386938, 7801679, 5020019, 5449617, 1648450, 466968, 526636, 5427915, 4293417, 5098134, 2779781, 1332486, 2147861, 5805650, 2563232, 6435730, 3940482, 6517875, 572186, 6293378, 4012364, 3941538, 1971968, 2809349, 8233899, 616815, 6429569, 3474086, 3135418, 4175637, 5621756, 6825926, 4108120, 1739836, 6792145, 2251860, 4119829, 7688522, 7829351, 7566859, 1313441, 367439, 241443, 4682997, 3212560, 6671437, 3226644, 4278600, 3090802, 2009336, 5052706, 7467958, 2144163, 915068, 6508849, 6155990, 4404243, 2939820, 1892688, 1664987, 8279350, 5278158, 8160094, 4901487, 7088096, 204366, 2385606, 1895933, 1319872, 6587455, 3348831, 485894, 5729593, 5636171, 6679460, 2390628, 7457950, 3457582, 6879627, 4574612, 6595564, 4164448, 2107577, 5873513, 2664537, 7044546, 3156780, 6978853, 3923620, 5600839, 5244757, 1894707, 585667, 4241348, 1722077, 2087784, 2671944, 5184230, 942460, 7020864, 2213193, 7124957, 6293960, 5369630, 3926154, 6591521, 201694, 1711942, 3626816, 1118915, 5782088, 3027904, 2190967, 6032329, 7171571, 4433273, 6323640, 5775317, 5117609, 6389872, 6117121, 6402647, 3283928, 2557816, 4552122, 3106767, 8199843, 4049739, 4475383, 6111656, 6525334, 1985829, 342888, 496823, 1229966, 1099759, 3345374, 5792942, 2848026, 6892148, 3122682, 891628, 2930021, 3104, 7571714, 4736346, 7138788, 3961614, 86993, 2235645, 4026841, 230125, 2515551, 2277930, 4374696, 2713240, 1667272, 4023269, 5553511, 5404480, 5056163, 2711720, 2935019, 333336, 7149523, 5175216, 1262749};

int32_t merging_zetas_inv[] = {8399816, 4961164, 1008909, 7587033, 4022974, 168238, 4578504, 1423777, 7599578, 7412158, 1049296, 4555543, 7435322, 6748782, 4333375, 5195832, 5513103, 1898872, 3631075, 3982730, 8312715, 2084085, 7580503, 2289491, 5751098, 3119565, 2758827, 2615800, 3009808, 2710049, 6439031, 1737755, 1118241, 2264587, 2475909, 6806087, 1964670, 7982562, 311707, 2103594, 8272761, 7346702, 1146614, 5974003, 6668827, 8327401, 8366416, 3006623, 3799321, 773487, 4330583, 2152180, 7738894, 5275571, 5633297, 684932, 3344648, 2760026, 2695318, 53224, 8368390, 7442395, 5136864, 578476, 3256333, 807070, 799628, 4351117, 6876821, 5123688, 3694721, 6239075, 4811306, 3468539, 1302255, 6643087, 85577, 1931622, 6757891, 5570093, 4836597, 4127120, 1356810, 5960660, 478862, 8053829, 8400286, 5400442, 6916230, 5915365, 2368774, 6444193, 4397110, 1111030, 5269030, 8221039, 3587303, 3707690, 1919795, 5864703, 217275, 6522856, 7221777, 7494503, 2877367, 91681, 3211008, 5626101, 8216831, 1968005, 6977179, 7968539, 4941460, 6848942, 2857960, 6284964, 5593209, 4118821, 5011382, 3742062, 8094839,7523930,875102,1847236,1976969,5714676 ,968342};
int32_t merging_zetas_inv_radix3[] = {5175216, 1262749, 333336, 7149523, 2711720, 2935019, 5404480, 5056163, 4023269, 5553511, 2713240, 1667272, 2277930, 4374696, 230125, 2515551, 2235645, 4026841, 3961614, 86993, 4736346, 7138788, 3104, 7571714, 891628, 2930021, 6892148, 3122682, 5792942, 2848026, 1099759, 3345374, 496823, 1229966, 1985829, 342888, 6111656, 6525334, 4049739, 4475383, 3106767, 8199843, 2557816, 4552122, 6402647, 3283928, 6389872, 6117121, 5775317, 5117609, 4433273, 6323640, 6032329, 7171571, 3027904, 2190967, 1118915, 5782088, 1711942, 3626816, 6591521, 201694, 5369630, 3926154, 7124957, 6293960, 7020864, 2213193, 5184230, 942460, 2087784, 2671944, 4241348, 1722077, 1894707, 585667, 5600839, 5244757, 6978853, 3923620, 7044546, 3156780, 5873513, 2664537, 4164448, 2107577, 4574612, 6595564, 3457582, 6879627, 2390628, 7457950, 5636171, 6679460, 485894, 5729593, 6587455, 3348831, 1895933, 1319872, 204366, 2385606, 4901487, 7088096, 5278158, 8160094, 1664987, 8279350, 2939820, 1892688, 6155990, 4404243, 915068, 6508849, 7467958, 2144163, 2009336, 5052706, 4278600, 3090802, 6671437, 3226644, 4682997, 3212560, 367439, 241443, 7566859, 1313441, 7688522, 7829351, 2251860, 4119829, 1739836, 6792145, 6825926, 4108120, 4175637, 5621756, 3474086, 3135418, 616815, 6429569, 2809349, 8233899, 3941538, 1971968, 6293378, 4012364, 6517875, 572186, 6435730, 3940482, 5805650, 2563232, 1332486, 2147861, 5098134, 2779781, 5427915, 4293417, 466968, 526636, 5449617, 1648450, 7801679, 5020019, 7945891, 4386938, 6359710, 7875963, 3459109, 1261167, 5571547, 710895, 5559678, 5408645, 7595588, 7690642, 821968, 4494445, 7001742, 7874901, 967589, 1394046, 1641973, 1787803, 1105642, 2359345, 1633202, 525574, 146560, 4014599, 2916424, 4609717, 7355223, 7281207, 5702415, 7798348, 5198125, 6023962, 560710, 1348692, 8161022, 3769495, 8281822, 4311765, 7920304, 1037912, 1100786, 4089772, 5327580, 745503, 6785910, 3791820, 7805834, 7061874, 2520594, 8379212, 7488303, 3191435, 4154298, 7052845, 2857261, 2377575, 3295236, 2838881, 1047748, 816064, 3788125, 6953534, 1012578, 1708640, 5418701, 8385878, 318122, 6455270, 438319, 67842, 2349929, 3348874, 270021, 8333695, 5970049, 6937875, 5130846, 5562656, 5969160, 5057514, 4155353, 892614, 6947179, 883906, 2746890, 15659, 5525650, 6692897, 2079298, 7336752, 2411258, 8061965, 5519289, 5186154, 8349902, 5810512, 4083424, 270114, 1097736, 7070697, 1675551, 4351181, 7768152, 8314312, 3271346, 4050356, 2274526, 5456268, 3063667, 1064785, 5934871, 5723287, 258976, 6005912, 2978262, 4011609, 5383208, 8131423, 1082847, 2591025, 7845810, 2157175, 667587, 1653412, 5678895, 4991839, 2032195, 2172644, 2634223, 5008924, 326103, 6365200, 2896051, 6800091, 5502127, 4806620, 8316386, 1601446, 5517655, 1599226, 5265114, 6244362, 3574146, 6979264, 295518, 120838, 3309611, 51966, 4142843, 3392613, 1084779, 6228893, 316844, 1784047, 4213423, 6403661, 6402334, 7644979, 3748470, 2916865, 2207387, 5649505, 3417988, 5216205, 1253114, 8046098, 4698106, 3865717, 6615927, 355439, 387443, 4892947, 3815064, 6617490, 2565047, 6782582, 3233448, 7000252, 7486996, 6048222, 7186745, 2752032, 4663564, 5484672, 6938845, 4408493, 6893471, 6459907, 5198194, 5185375, 693331, 4358645, 1094223, 5036500, 1521152, 4024395, 521183, 3812325, 7643252, 5056524, 6361249, 4589212, 6367918, 1820338, 2169683, 3993044, 2836346, 1013632, 2738253, 31351, 7792083, 1870695, 4949988, 3365037, 5215641, 4042892, 2154908, 4803488, 4605560, 4683983, 1794968, 7231937, 5166111, 2161462, 125372, 33386, 2405954, 413166, 8170391, 802870, 4768038, 3762952, 3830902, 7598667, 5797824, 7265323, 5161793, 3598049, 35252, 5924414, 99336, 5216654, 7486873, 5486853, 5775104, 8368151, 7433838, 6240075, 422949, 1484086, 8034990, 7152237, 4038844, 2902674, 5814750, 363290, 8002439, 6470946, 4224895, 4536844, 6712821, 5490550, 3278486, 4304560, 3167615, 2910987, 6231802, 972083, 5349334, 6917451, 1128088, 4667850, 779309, 6020930, 6753105, 4241250, 6732205, 1930591, 4965202, 8038247, 4439090, 2489396, 4350830, 8185144, 6154074, 7182136, 1624362, 1419245, 110922, 6399331, 5212315, 4594763, 6237576, 5676344, 6838596, 5639237, 8364935, 2725193, 1029201, 5179930, 5680212, 5912141, 2280675, 7058482, 3151447, 7084159, 386535, 5459951, 2000622, 2002206, 5366704, 6982292, 6358048, 2174534, 7540196, 3827069, 5052715, 2721684, 5051056, 3164885, 1106173, 4851116, 2194640, 7298667, 2613809, 1238032, 730565, 3719883, 5983894, 7163505, 6241571, 7572800, 868824, 6227003, 88165, 6884768, 1667742, 1071664, 6279939, 5065101, 7402811, 3550421, 1672121, 5236652, 7376204, 8356593, 1827084, 3773663, 5728214, 5066955, 6609610, 5614902, 8013418, 8157701, 311750, 101357, 2102600, 6193693, 8028620, 7818912, 8188766, 2207844, 877240, 4823119, 5492095, 44944, 6194638, 5032277, 7871804, 56413, 4940590, 1565819, 5300999, 243836, 1674074, 2786635, 5939777, 4706756, 5448151, 2815485, 1837278, 4704397, 2207645, 2616760, 7593818, 710939, 7352045, 4011819, 7753405, 5194264, 1995241, 6037042, 452555, 3207273, 6016716, 5415336, 6911650, 3694781, 4320431, 252265, 4402068, 317038, 6502344, 8009749, 905530, 7690598, 7639038, 5784777, 718978, 2936435, 6758531, 6550493, 6915676, 7319049, 7083542, 6896734, 4988024, 5871864, 7892769, 2686897, 7029097, 2627384, 2922670, 3828976, 2758040, 5774153, 5787086, 4789376, 2209806, 5465102, 1846049, 2324173, 5769014, 5623332, 332153, 776340, 5732876, 2529673, 433968, 1504803, 1952112, 1370218, 1932093, 8032570, 6397371, 6443498, 97875, 3998335, 3492578, 849340, 1372155, 2904114, 334192, 5044260, 126705, 1036112, 3937736, 3357277, 5691014, 7292838, 4724383, 7031319, 2603493, 5034447, 5494430, 4274332, 1214256, 4675293, 5971606, 7552197, 913651, 4403202, 4865068, 7855960, 3911736, 6542339, 1554066, 6623746, 837334, 2840662, 631538, 149890, 1169641, 2751828, 8069214, 6518660, 7613357, 3287031, 8123459, 1882877, 7298144, 6773636, 7579864, 545577, 7777014, 6127693, 6534493, 2206251, 1433627, 4659462, 6661532, 8251647, 5324318, 5560875, 7086664, 271090, 2986958, 7102404, 7030537, 1722780, 471459, 4466201, 1659243, 5533938, 1565727, 4534920, 4931633, 1674900, 3824161, 20244, 4127023, 6726637, 8036213, 7256718, 2911167, 8130447, 1328031, 4486445, 3522876, 4806010, 6066303, 375767, 4090292, 2867599, 514029, 3935336, 3492407, 2533792, 1048954, 4634706, 1645681, 3556531, 6576914, 5010677, 5033868, 5066962, 4531429, 7407065, 3870025, 6050743, 4607652, 1911148, 4621787, 2350794, 7702617, 221956, 494139, 5867745, 5221396, 6921825, 348882, 1539320, 3057769, 2283912, 7425926, 3334575, 4794542, 3390860, 6168821, 1598821, 3834447, 506797, 2426084, 6556192, 8163426, 3328024, 5084688, 5034910, 3156148, 8259591, 7208192, 880634, 130820, 3724159, 1048441, 7520903, 676078, 3189565, 4973489, 6802716, 3965136, 7052183, 5435217, 1456875, 6673736, 1387431, 1560222, 3366627, 6786372, 5073513, 6490674, 5320794, 5084858, 3601839, 4902281, 4718708, 3600911, 1604943, 7229206, 1034912, 5320068, 841088, 694493, 6940100, 7441504, 3520481, 7726772, 1461437, 259546, 5753620, 6856111, 3080743, 273132, 5125424, 2378882, 6161882, 336813, 2140402, 3682449, 7366625, 8025058, 6796594, 1618071, 5810463, 2604530, 2233038, 116406, 4832424, 4514923, 4216216, 301773, 13425, 97634, 65984, 1272944, 2005871, 2222840, 5109852, 3895548, 6395666, 7364365, 4845849, 2837347, 2591074, 1311251, 924531, 750546, 5876447, 2257957, 4238909, 4911153, 8388112, 7355171, 4185321, 104652, 4590814, 4563661, 6779017, 3916284, 4378844, 7192649, 6029292, 461062, 5712351, 7749009, 1662577, 7110541, 1028554, 7548598, 3576038, 4760685, 7372983, 3050069, 1689658, 8398078, 3810723, 8227131, 1203793, 1186891, 6253391, 3381791, 7807571, 5700908, 2689186, 3844299, 2372245, 7364226, 8076372, 7389544, 5680014, 7387824, 4700918, 8223422, 4415302, 1389189, 6639653, 544749, 4912952, 1822626, 7069399, 2235158, 737891, 7937225, 1332138, 4336178, 2939034, 2338904, 325165, 6301921, 5153193, 146701, 4587787, 7442507, 4347876, 6427198, 1761884, 6000207, 3986235, 4137664, 617338, 6186475, 239342, 3988549, 5623394, 1335085, 3775028, 1972010, 1107556, 1610847, 5714625, 6785547, 582962, 4870071, 1925728, 5995097, 7818575, 2850064, 6730950, 8248400, 7784199, 5067109, 5700756, 1272183, 6331963, 7269149, 822304, 5544997, 7293981, 8164013, 4626509, 6705351, 986907, 5795677, 5539677, 2037329, 1200635, 5659819, 5903590, 1780643, 6956689, 1623184, 7189620, 2884256, 5382519, 259380, 7739136, 891074, 3019018, 5451998, 8157324, 5619998, 7414630, 5640971, 5241189, 8114824, 8176527, 2867333, 2520659, 1729880, 1444848, 2762523, 2497947, 5982363, 3022187, 350843, 5961903, 1998401, 3709568, 3989177, 5120031, 1286086, 2128851, 1463651, 2213858, 6366809, 4243762, 1253810, 4455451, 8032750, 4157775, 7224001, 5838419, 1525494, 5379350, 2809088, 1173945, 4912184, 5236045, 5312884, 1804128, 6768989, 6272686, 6400991, 3281506, 7670156, 4308725, 7040902, 5766783, 7289392, 8251446, 3547575, 1555949, 5677537, 7345587, 869976, 7513996, 7779633, 2216272, 3723422, 1882396, 5728828, 6185265, 1416683, 7195496, 4410150, 4092812, 3919256, 3438345, 8357888, 3421184, 5397364, 7983055, 6665025, 1055950, 166697, 6845588};


#elif NIMS_TRI_NTT_MODE == 3
//Q = 8397313
//zeta = 86054 //(2^9*3)th root of unity
//invMONT = 4329369 // 2^(-32) mod Q
//invzeta = 1755596 //zeta^(-1) mod Q
//W = 5661571 //zeta^(2^9) mod Q
#define MONT 3940353 // 2^32 % Q

#define Wmont	1050121 //mont * W (W : 3rd root of unity)
#define W2mont	3406839 //mont * W^2
#define	F1	2250740 //mont^2/2^9
#define F2	4501480 //mont^2/2^8

#define radix3_len 1 //radix-3 1번
#define radix2_redlen_ntt (N>>8)
#define radix2_redlen_invntt (N>>3)

int32_t zetas[511] = {
		4990474, 3227855, 2268138, 972348, 2337085, 124959, 4479337, 3667838, 5689912, 6644273,
6934194, 6934665, 1538485, 5896473, 152433, 971564, 6152987, 6328434, 6948882, 574790,
1459554, 5672534, 2982539, 383382, 2182644, 3631088, 6117417, 3514437, 3273452, 4262990,
2598551, 2624740, 3204729, 7745421, 1375023, 171112, 5348856, 1032490, 4589664, 2395811,
8343591, 6071282, 7365101, 4401765, 3583379, 2167158, 2285110, 5289144, 3923560, 7953169,
6722707, 4715825, 6465037, 5854021, 3783550, 5071907, 7765640, 892445, 6144516, 240402,
349876, 7886275, 4087106, 1235584, 7011869, 7497916, 4385583, 5168591, 6832874, 240718,
7123460, 3247067, 2567789, 70496, 656034, 1873626, 3512977, 1195040, 413771, 1924321,
655407, 7136014, 4078101, 476272, 2621588, 3456051, 8154728, 1434739, 7591357, 1545373,
7524556, 4408881, 395308, 2362032, 2300880, 4839465, 6374899, 4099598, 5945650, 6595643,
2290135, 5221968, 132753, 7121619, 3771421, 8169963, 4758324, 3398805, 375361, 6746501,
7808337, 3951210, 7984859, 2721906, 911361, 4486605, 4515839, 6133174, 4398986, 42606,
5516164, 8006412, 4059425, 6710531, 1783116, 3836780, 8104958, 4584505, 7432834, 3234870,
6858061, 4934201, 6097734, 4201686, 6901396, 8050176, 383341, 2806294, 6185977, 5867038,
2614166, 6786110, 2655361, 5533954, 4583186, 4546610, 430326, 3064313, 6284076, 6224373,
6963213, 7190978, 2271090, 6422994, 8213843, 2771607, 6190754, 6025246, 8046867, 8302794,
570546, 1327008, 6745812, 547559, 4076162, 5273742, 3184165, 4293535, 1289247, 6071198,
2375675, 1099499, 7458138, 2985263, 1376941, 1651505, 3963832, 7439099, 2260402, 8373167,
4117372, 3162151, 1919551, 621337, 1739534, 355419, 907301, 4746577, 7254367, 8041444,
4753267, 8285032, 6005209, 3191271, 1740753, 4591869, 8178904, 264532, 2479834, 5802854,
6196469, 1672317, 2149662, 117314, 3237267, 8013170, 370, 8179771, 4319762, 2114157,
4927297, 4393190, 2283578, 4205126, 7295526, 6246517, 1493570, 2939653, 5769134, 6845391,
8348858, 6241339, 5831293, 1416315, 4894611, 7795494, 8356971, 1904796, 2739086, 1298122,
1629867, 1421572, 2250284, 4222267, 3962274, 389160, 7092123, 3024641, 3496326, 6075004,
517124, 6618785, 8114979, 7703944, 1138889, 1240465, 28163, 1844240, 4686552, 2160386,
5512594, 7760014, 6244796, 7519805, 7161983, 8035435, 7116149, 5255994, 1053086, 5380821,
2490361, 3078953, 149966, 2662323, 6070477, 6586811, 7917965, 4318848, 2309794, 4944749,
6427458, 7066165, 1665386, 3238601, 5942938, 7455976, 1240339, 2153217, 7351999, 7424505,
5128736, 1964008, 4933934, 7542235, 5484370, 4126028, 4335755, 2123869, 8383463, 6596552,
5299166, 1587176, 4331708, 2144326, 7675927, 7611731, 1924818, 4287429, 6887651, 2501720,
534250, 1586814, 823900, 1723218, 731520, 5445059, 915930, 7412321, 1194060, 4420009,
5185427, 5793152, 935050, 1434946, 1292678, 6436655, 3310160, 6291589, 3533008, 7920168,
1306171, 2403825, 913285, 6464803, 578918, 8124486, 4454472, 4880977, 4491304, 605859,
1284361, 1368247, 1242552, 7739441, 6060253, 5769475, 3519455, 1997286, 8209646, 210912,
144531, 6115752, 7236238, 2474096, 4399603, 4172254, 2943434, 5812702, 6934208, 8172729,
5905199, 4419443, 1556603, 1645864, 5392445, 2845077, 2354190, 432934, 1610786, 2080041,
3459615, 6330916, 5622139, 7777805, 3132481, 5691738, 7623872, 2107815, 6104719, 747509,
8091014, 2992206, 1708614, 5120584, 1405816, 4056285, 4620372, 6172929, 3119643, 4697378,
5401179, 6573747, 3296606, 168330, 2051998, 1324483, 4918636, 5849556, 7885623, 6972914,
6775153, 2513543, 1620324, 3602798, 7611850, 4602204, 2454758, 4477162, 2042514, 506974,
4039870, 3843692, 4795871, 6223248, 4320007, 7775546, 310528, 7734180, 6067756, 5679474,
1336594, 2846921, 319669, 5340563, 8081606, 3320228, 4969396, 4516760, 6432898, 2805090,
1849375, 38833, 3936574, 3608060, 8263553, 3265463, 3601393, 613565, 751432, 7449517,
866476, 838550, 7268449, 4201000, 8140982, 7056512, 3513122, 7116264, 594751, 7541803,
6216020, 5034645, 6572193, 4971789, 3862199, 8261442, 7159345, 3078089, 1613266, 4307595,
7489368, 4734398, 6615721, 7318498, 7117080, 4183258, 1567826, 4814237, 2605671, 1768730,
7312956, 3179559, 6648041, 5648722, 547264, 3880333, 8090729, 4541000, 5499699, 2503695,
882585, 576849, 6797315, 8242450, 7912676, 1770164, 3717991, 46826, 7854881, 970128,
32227, 5694358, 4897114, 8162537, 5128047, 7533062, 4653092, 8298417, 3901556, 8025534,
5029744, 290396, 5638428, 7740179, 5510127, 3673401, 3227109, 8375539, 5853786, 4130252,
913983, 332254, 5112658, 3410573, 7191670, 1744337, 8155393, 723057, 3629549, 3962377,
4894760
};


int32_t merging_zetas[] = {4990474, 3227855, 2268138, 972348, 2337085, 124959, 4479337, 3667838, 971564, 6152987, 2624740, 3204729, 7745421, 1375023, 5689912, 6328434, 6948882, 171112, 5348856, 1032490, 4589664, 6644273, 574790, 1459554, 2395811, 8343591, 6071282, 7365101, 6934194, 5672534, 2982539, 4401765, 3583379, 2167158, 2285110, 6934665, 383382, 2182644, 5289144, 3923560, 7953169, 6722707, 1538485, 3631088, 6117417, 4715825, 6465037, 5854021, 3783550, 5896473, 3514437, 3273452, 5071907, 7765640, 892445, 6144516, 152433, 4262990, 2598551, 240402, 349876, 7886275, 4087106, 1235584, 4584505, 7432834, 8035435, 7116149, 5255994, 1053086, 7011869, 3234870, 6858061, 5380821, 2490361, 3078953, 149966, 7497916, 4934201, 6097734, 2662323, 6070477, 6586811, 7917965, 4385583, 4201686, 6901396, 4318848, 2309794, 4944749, 6427458, 5168591, 8050176, 383341, 7066165, 1665386, 3238601, 5942938, 6832874, 2806294, 6185977, 7455976, 1240339, 2153217, 7351999, 240718, 5867038, 2614166, 7424505, 5128736, 1964008, 4933934, 7123460, 6786110, 2655361, 7542235, 5484370, 4126028, 4335755, 3247067, 5533954, 4583186, 2123869, 8383463, 6596552, 5299166, 2567789, 4546610, 430326, 1587176, 4331708, 2144326, 7675927, 70496, 3064313, 6284076, 7611731, 1924818, 4287429, 6887651, 656034, 6224373, 6963213, 2501720, 534250, 1586814, 823900, 1873626, 7190978, 2271090, 1723218, 731520, 5445059, 915930, 3512977, 6422994, 8213843, 7412321, 1194060, 4420009, 5185427, 1195040, 2771607, 6190754, 5793152, 935050, 1434946, 1292678, 413771, 6025246, 8046867, 6436655, 3310160, 6291589, 3533008, 1924321, 8302794, 570546, 7920168, 1306171, 2403825, 913285, 655407, 1327008, 6745812, 6464803, 578918, 8124486, 4454472, 7136014, 547559, 4076162, 4880977, 4491304, 605859, 1284361, 4078101, 5273742, 3184165, 1368247, 1242552, 7739441, 6060253, 476272, 4293535, 1289247, 5769475, 3519455, 1997286, 8209646, 2621588, 6071198, 2375675, 210912, 144531, 6115752, 7236238, 3456051, 1099499, 7458138, 2474096, 4399603, 4172254, 2943434, 8154728, 2985263, 1376941, 5812702, 6934208, 8172729, 5905199, 1434739, 1651505, 3963832, 4419443, 1556603, 1645864, 5392445, 7591357, 7439099, 2260402, 2845077, 2354190, 432934, 1610786, 1545373, 8373167, 4117372, 2080041, 3459615, 6330916, 5622139, 7524556, 3162151, 1919551, 7777805, 3132481, 5691738, 7623872, 4408881, 621337, 1739534, 2107815, 6104719, 747509, 8091014, 395308, 355419, 907301, 2992206, 1708614, 5120584, 1405816, 2362032, 4746577, 7254367, 4056285, 4620372, 6172929, 3119643, 2300880, 8041444, 4753267, 4697378, 5401179, 6573747, 3296606, 4839465, 8285032, 6005209, 168330, 2051998, 1324483, 4918636, 6374899, 3191271, 1740753, 5849556, 7885623, 6972914, 6775153, 4099598, 4591869, 8178904, 2513543, 1620324, 3602798, 7611850, 5945650, 264532, 2479834, 4602204, 2454758, 4477162, 2042514, 6595643, 5802854, 6196469, 506974, 4039870, 3843692, 4795871, 2290135, 1672317, 2149662, 6223248, 4320007, 7775546, 310528, 5221968, 117314, 3237267, 7734180, 6067756, 5679474, 1336594, 132753, 8013170, 370, 2846921, 319669, 5340563, 8081606, 7121619, 8179771, 4319762, 3320228, 4969396, 4516760, 6432898, 3771421, 2114157, 4927297, 2805090, 1849375, 38833, 3936574, 8169963, 4393190, 2283578, 3608060, 8263553, 3265463, 3601393, 4758324, 4205126, 7295526, 613565, 751432, 7449517, 866476, 3398805, 6246517, 1493570, 838550, 7268449, 4201000, 8140982, 375361, 2939653, 5769134, 7056512, 3513122, 7116264, 594751, 6746501, 6845391, 8348858, 7541803, 6216020, 5034645, 6572193, 7808337, 6241339, 5831293, 4971789, 3862199, 8261442, 7159345, 3951210, 1416315, 4894611, 3078089, 1613266, 4307595, 7489368, 7984859, 7795494, 8356971, 4734398, 6615721, 7318498, 7117080, 2721906, 1904796, 2739086, 4183258, 1567826, 4814237, 2605671, 911361, 1298122, 1629867, 1768730, 7312956, 3179559, 6648041, 4486605, 1421572, 2250284, 5648722, 547264, 3880333, 8090729, 4515839, 4222267, 3962274, 4541000, 5499699, 2503695, 882585, 6133174, 389160, 7092123, 576849, 6797315, 8242450, 7912676, 4398986, 3024641, 3496326, 1770164, 3717991, 46826, 7854881, 42606, 6075004, 517124, 970128, 32227, 5694358, 4897114, 5516164, 6618785, 8114979, 8162537, 5128047, 7533062, 4653092, 8006412, 7703944, 1138889, 8298417, 3901556, 8025534, 5029744, 4059425, 1240465, 28163, 290396, 5638428, 7740179, 5510127, 6710531, 1844240, 4686552, 3673401, 3227109, 8375539, 5853786, 1783116, 2160386, 5512594, 4130252, 913983, 332254, 5112658, 3836780, 7760014, 6244796, 3410573, 7191670, 1744337, 8155393, 8104958, 7519805, 7161983, 723057, 3629549, 3962377, 4894760};
int32_t merging_zetas_inv[] = {3502553, 4434936, 4767764, 7674256, 1235330, 877508, 292355, 241920, 6652976, 1205643, 4986740, 2152517, 637299, 4560533, 3284655, 8065059, 7483330, 4267061, 2884719, 6236927, 6614197, 2543527, 21774, 5170204, 4723912, 3710761, 6553073, 1686782, 2887186, 657134, 2758885, 8106917, 8369150, 7156848, 4337888, 3367569, 371779, 4495757, 98896, 7258424, 693369, 390901, 3744221, 864251, 3269266, 234776, 282334, 1778528, 2881149, 3500199, 2702955, 8365086, 7427185, 7880189, 2322309, 8354707, 542432, 8350487, 4679322, 6627149, 4900987, 5372672, 3998327, 484637, 154863, 1599998, 7820464, 1305190, 8008153, 2264139, 7514728, 5893618, 2897614, 3856313, 4435039, 4175046, 3881474, 306584, 4516980, 7850049, 2748591, 6147029, 6975741, 3910708, 1749272, 5217754, 1084357, 6628583, 6767446, 7099191, 7485952, 5791642, 3583076, 6829487, 4214055, 5658227, 6492517, 5675407, 1280233, 1078815, 1781592, 3662915, 40342, 601819, 412454, 907945, 4089718, 6784047, 5319224, 3502702, 6980998, 4446103, 1237968, 135871, 4535114, 3425524, 2566020, 2155974, 588976, 1825120, 3362668, 2181293, 855510, 48455, 1551922, 1650812, 7802562, 1281049, 4884191, 1340801, 2628179, 5457660, 8021952, 256331, 4196313, 1128864, 7558763, 6903743, 2150796, 4998508, 7530837, 947796, 7645881, 7783748, 1101787, 4192187, 3638989, 4795920, 5131850, 133760, 4789253, 6113735, 4004123, 227350, 4460739, 8358480, 6547938, 5592223, 3470016, 6283156, 4625892, 1964415, 3880553, 3427917, 5077085, 4077551, 217542, 1275694, 315707, 3056750, 8077644, 5550392, 8396943, 384143, 8264560, 7060719, 2717839, 2329557, 663133, 5160046, 8279999, 3175345, 8086785, 621767, 4077306, 2174065, 6247651, 6724996, 6107178, 3601442, 4553621, 4357443, 7890339, 2200844, 2594459, 1801670, 6354799, 3920151, 5942555, 3795109, 5917479, 8132781, 2451663, 785463, 4794515, 6776989, 5883770, 218409, 3805444, 4297715, 1622160, 1424399, 511690, 2547757, 6656560, 5206042, 2022414, 3478677, 7072830, 6345315, 8228983, 2392104, 112281, 3557848, 5100707, 1823566, 2996134, 3699935, 3644046, 355869, 6096433, 5277670, 2224384, 3776941, 4341028, 1142946, 3650736, 6035281, 6991497, 3276729, 6688699, 5405107, 7490012, 8041894, 8002005, 306299, 7649804, 2292594, 6289498, 6657779, 7775976, 3988432, 773441, 2705575, 5264832, 619508, 6477762, 5235162, 872757, 2775174, 2066397, 4937698, 6317272, 4279941, 24146, 6851940, 6786527, 7964379, 6043123, 5552236, 6136911, 958214, 805956, 3004868, 6751449, 6840710, 3977870, 4433481, 6745808, 6962574, 2492114, 224584, 1463105, 2584611, 7020372, 5412050, 242585, 5453879, 4225059, 3997710, 5923217, 939175, 7297814, 4941262, 1161075, 2281561, 8252782, 8186401, 6021638, 2326115, 5775725, 187667, 6400027, 4877858, 2627838, 7108066, 4103778, 7921041, 2337060, 657872, 7154761, 7029066, 5213148, 3123571, 4319212, 7112952, 7791454, 3906009, 3516336, 4321151, 7849754, 1261299, 3942841, 272827, 7818395, 1932510, 1651501, 7070305, 7741906, 7484028, 5993488, 7091142, 477145, 7826767, 94519, 6472992, 4864305, 2105724, 5087153, 1960658, 350446, 2372067, 7983542, 7104635, 6962367, 7462263, 2604161, 2206559, 5625706, 7202273, 3211886, 3977304, 7203253, 984992, 183470, 1974319, 4884336, 7481383, 2952254, 7665793, 6674095, 6126223, 1206335, 6523687, 7573413, 6810499, 7863063, 5895593, 1434100, 2172940, 7741279, 1509662, 4109884, 6472495, 785582, 2113237, 5333000, 8326817, 721386, 6252987, 4065605, 6810137, 7966987, 3850703, 5829524, 3098147, 1800761, 13850, 6273444, 3814127, 2863359, 5150246, 4061558, 4271285, 2912943, 855078, 5741952, 1611203, 1273853, 3463379, 6433305, 3268577, 972808, 5783147, 2530275, 8156595, 1045314, 6244096, 7156974, 941337, 2211336, 5591019, 1564439, 2454375, 5158712, 6731927, 1331148, 8013972, 347137, 3228722, 1969855, 3452564, 6087519, 4078465, 1495917, 4195627, 4011730, 479348, 1810502, 2326836, 5734990, 2299579, 3463112, 899397, 8247347, 5318360, 5906952, 3016492, 1539252, 5162443, 1385444, 7344227, 3141319, 1281164, 361878, 964479, 3812808, 7161729, 4310207, 511038, 8047437, 8156911, 5798762, 4134323, 8244880, 2252797, 7504868, 631673, 3325406, 5123861, 4882876, 2500840, 4613763, 2543292, 1932276, 3681488, 2279896, 4766225, 6858828, 1674606, 444144, 4473753, 3108169, 6214669, 8013931, 1462648, 6112203, 6230155, 4813934, 3995548, 5414774, 2724779, 1463119, 1032212, 2326031, 53722, 6001502, 6937759, 7822523, 1753040, 3807649, 7364823, 3048457, 8226201, 1448431, 2068879, 2707401, 7022290, 651892, 5192584, 5772573, 2244326, 7425749, 4729475, 3917976, 8272354, 6060228, 7424965, 6129175, 5169458, 3584677};
#elif NIMS_TRI_NTT_MODE == 5
//Q = 8404993
//zeta = 4184677 //(2^8*3^3)th root of unity
//invMONT = 7896129
//invzeta = 1554873
//W = 6999551
#define MONT 15873 // 2^32 % Q
#define Wmont	6675549 //mont * W (W : 3rd root of unity)
#define W2mont	1713571 //mont * W^2
#define	F1	6642923 //mont^2/N
#define F2	4880853 //2 * mont^2/N

#define radix3_len 3 //radix-3 2번
#define radix2_redlen_ntt (N>>8)
#define radix2_redlen_invntt (N>>3)

int32_t merging_zetas[] = {6691422, 3745396, 1005959, 5560684, 557530, 1359546, 5166674, 5884035, 6365869, 2241533, 2021449, 3517630, 7346728, 4905548, 4422884, 6130832, 3005748, 5238671, 3440514, 4703105, 940539, 4240425, 2818295, 1059740, 2892723, 6587485, 4244468, 3541424, 5387571, 1575156, 6639601, 3284715, 964913, 106719, 2439163, 1046739, 1563110, 7206912, 2652420, 2954142, 8379323, 7950516, 2694230, 1200488, 285221, 8059860, 1193423, 7129183, 7731829, 3252563, 8040721, 2282474, 264713, 8060094, 445982, 8011185, 6563702, 6468071, 4739225, 1369059, 7955478, 5679661, 6136964, 5113226, 7951916, 2149249, 3683432, 4851479, 6738222, 7938303, 7925831, 1335443, 6949595, 8252838, 2533493, 5152479, 351317, 69907, 1033092, 2530659, 67928, 1728878, 4628830, 6097080, 8278066, 6520199, 7059579, 3908887, 3741732, 5872664, 4478964, 1844725, 3046182, 1661123, 6710463, 1533306, 751008, 777419, 8184245, 3037667, 87056, 7368142, 1719154, 4291236, 613216, 4320384, 4955376, 1690952, 7339862, 4474239, 6784644, 4426392, 2909821, 7943851, 7097598, 948115, 3618608, 7116055, 3420707, 4466850, 3331941, 8249857, 4873863, 1686410, 2031465, 2812877, 6321919, 7672067, 1196093, 1086929, 1679678, 6892943, 6201985, 280851, 4838437, 1269346, 286108, 2180160, 4028114, 5946783, 3280475, 1093944, 2953005, 5294676, 3364626, 1176, 5818203, 7532885, 7589923, 6465761, 7083882, 5542137, 6290777, 6208581, 4603252, 7727308, 6588778, 625905, 6148742, 2989190, 4934225, 8349238, 4018245, 6933212, 7729342, 905487, 3845758, 1099113, 7903618, 6380048, 1313510, 6818581, 1844170, 4995993, 2510402, 8090989, 460717, 3495458, 2321474, 6689731, 8269219, 6053013, 577288, 5100927, 3209389, 3044372, 4821549, 2313948, 1145465, 7197271, 7998760, 2770361, 7365006, 5631248, 2577595, 7566618, 7779883, 3552194, 5426137, 226028, 4944063, 1390757, 4270717, 4051664, 4282185, 4953682, 4416567, 3438679, 1351657, 806825, 4615431, 574573, 304984, 4943292, 6607630, 5841098, 483603, 6844990, 5184478, 8193371, 5421164, 4815963, 1190228, 7879235, 7430274, 2472636, 6207605, 3475370, 7326792, 459765, 7611163, 4641031, 7678294, 5352327, 6575361, 7606168, 278548, 6820008, 675466, 7583149, 586507, 70338, 6948390, 8339833, 4509876, 7342567, 1302054, 3044034, 3566248, 7839232, 4994119, 2649626, 2038881, 7118134, 2661184 };
int32_t merging_zetas_radix3[] = {5187630, 5567006, 7123335, 2138750, 1307768, 1405381, 56522, 5496949, 3283020, 3077132, 2803881, 3273713, 3841362, 5379076, 4698559, 276591, 7100721, 239145, 2124750, 8128402, 1573250, 365669, 926563, 6266243, 7205603, 2837987, 2965391, 7517826, 7603213, 1681972, 8265246, 5131280, 6533880, 5628597, 1076883, 2510840, 7454905, 719370, 6838166, 2017962, 1525979, 3521817, 6883480, 4528273, 8379093, 4724763, 8200884, 3796430, 7068951, 745421, 6258932, 4608563, 3043161, 6546235, 197274, 5894153, 2338364, 2776396, 1661017, 7235603, 5164872, 4515800, 6713958, 3876720, 433795, 5317839, 3053345, 3284897, 1708002, 2889477, 5987846, 7928632, 8103639, 7215594, 3776738, 2437214, 7405893, 4370531, 3581890, 6109011, 1761601, 4128440, 2887591, 2295982, 2836279, 1960853, 4883958, 5120096, 7301990, 3087154, 5661133, 7655428, 3682426, 593495, 4831078, 5967779, 1918808, 3078610, 5928489, 3218336, 4579567, 6368024, 4815956, 90881, 4189694, 6955843, 5969652, 5609893, 5417020, 4423403, 5480542, 309582, 4221177, 1629460, 1978525, 8095411, 1207855, 5700774, 37923, 5186657, 7060028, 5326383, 2516353, 7641739, 7729595, 6677606, 4307141, 2795100, 6623753, 5696947, 220591, 640958, 2490308, 964338, 6124052, 1289973, 561790, 2226114, 1289222, 7143007, 7341160, 1046318, 1004253, 803840, 1845714, 7923061, 4968594, 7601153, 6826739, 27987, 965528, 7764035, 7669702, 2708046, 7483526, 1687276, 4184278, 1768178, 6392363, 1261986, 1693494, 5397589, 1195165, 4141818, 3173353, 4012934, 4080321, 2597113, 3206900, 3797749, 3427919, 2351765, 3958285, 3053419, 6236896, 6036004, 2675293, 790345, 6565165, 2368989, 3435061, 4948878, 1630666, 4263175, 7149337, 3007404, 233076, 7195237, 7227670, 1643945, 1982341, 6053228, 2084479, 3675838, 1385379, 3849778, 6300791, 5455581, 7245500, 2815114, 6894862, 2267012, 1906899, 2685377, 7016262, 7311930, 1356060, 2622406, 1037511, 5942850, 4575684, 5782587, 4616282, 5500491, 1731939, 4555215, 4928233, 4729155, 3409280, 2756715, 7967488, 8077987, 2966254, 5719616, 3877418, 1560352, 3542387, 6821894, 8143183, 833038, 6448849, 1482126, 4245121, 4513011, 1059673, 6017397, 6030946, 887784, 4724656, 3717125, 4840800, 6073363, 308157, 4687868, 6698800, 7499523, 2685500, 1583099, 4816015, 6844641, 1954392, 7709678, 4402060, 4550163, 688220, 2387596, 3496258, 7711960, 4775139, 6917896, 82329, 2884498, 2051694, 826626, 1502833, 5071781, 2350266, 2319634, 654376, 997529, 2986542, 2445560, 1065441, 4378748, 1535266, 5959433, 4324123, 3146260, 3929613, 1487097, 2278413, 693033, 6303576, 7915425, 4020654, 5330058, 6080344, 6085359, 3998155, 3138798, 5801151, 335479, 6137798, 8199468, 2134627, 7769572, 3918781, 4062299, 7833721, 590575, 3947129, 7020596, 316758, 7477612, 5597631, 7201097, 1458408, 927381, 198719, 8360147, 3887307, 8069514, 577673, 5266195, 4594806, 7356075, 2434996, 7272087, 1682318, 7814418, 6348454, 7651632, 286150, 5212041, 7950325, 6516880, 7445307, 3827543, 1615887, 3007373, 8240463, 5431617, 3567907, 7437147, 2645777, 515993, 7290967, 2254012, 5147067, 7889000, 6205316, 854167, 1487418, 3192952, 7314433, 753361, 6679782, 4244195, 1118784, 7032873, 122290, 2973376, 2928390, 4116231, 8403952, 5342346, 3734452, 6813007, 4020, 7770593, 1957313, 7537819, 1721544, 6697026, 595299, 7709814, 4760469, 1231240, 1910632, 3249057, 7456006, 7173753, 2234481, 6062626, 7564399, 3062647, 5449879, 4288762, 8108525, 4647167, 7329055, 8044247, 1968406, 1707967, 5471251, 4682175, 6792039, 2905847, 4975695, 6315216, 7754677, 7294932, 5899177, 4178133, 2734127, 1153766, 1020684, 3489312, 874428, 2802528, 7561898, 455315, 923239, 5602465, 8247009, 43705, 2030009, 5499146, 1176741, 3722818, 1845114, 6395159, 4875941, 712751, 2490863, 7251227, 6347835, 5794072, 6904101, 436055, 1151372, 5049782, 8218140, 2008432, 5869587, 4163177, 2952259, 8234385, 5655169, 53285, 2672259, 375556, 7736376, 1552256, 1275616, 8029437, 4695563, 1837824, 7596703, 7968938, 6717711, 2610921, 5734707, 489340, 7195223, 5425338, 3190534, 170608, 3017256, 2194791, 2560193, 2134780, 182827, 2002037, 8304009, 1255109, 4233387, 6193357, 7961863, 552180, 2508166, 4068464, 4884289, 1026249, 4377683, 8388148, 1308532, 7378744, 3556943, 1807289, 4030085, 6270213, 5777692, 6210202, 1584807, 6203244, 6780739, 3028286, 6184712, 7852813, 432750, 7666377, 4882442, 1459264, 3706138, 3762892, 7595908, 704511, 5915709, 6477821, 6272386, 6848979, 3408152, 8237228, 775088, 4402245, 1019926, 5739205, 3798532, 4002748, 4617399, 7553490, 7542783, 6945729, 523805, 738616, 3718955, 1291499, 3601184, 8165137, 4822348, 1556014, 7006888, 7147319, 2868962, 5762218, 8101442, 1558317, 256852, 2120844, 1205793, 1024022, 4544227, 8014656, 4089620, 8119927, 2386297, 6889861, 4810963, 8171341, 1061026, 1515132, 7862474, 1730507, 1061927, 2642775, 6449055, 1257674, 2199724, 5477152, 4415594, 43185, 2695898, 390337, 4099298, 8043782, 1220102, 579728, 98416, 2460326, 5316226, 1011326, 7046327, 7938055, 3559563, 7468522, 5296878, 5941644, 3088345, 2246080, 6603656, 7576844, 861518, 6158913, 5739839, 74855, 4569434, 7825265, 4933087, 361211, 4218374, 6521372, 2167149, 4706406, 6357485, 936471, 4164473, 2064455, 1114166, 3601159, 64479, 7214988, 4296225, 2003667, 5042866, 7464427, 6920201, 1682448, 6048652, 6122539, 1204287, 7070112, 5085005, 1123889, 2339278, 1334881, 7429373, 3686115, 2423427, 4803834, 6985765, 6340538, 5561365, 1318705, 5065261, 5880107, 2600386, 6722545, 5398894, 8059407, 2960884, 137000, 4676572, 8287716, 1016086, 913101, 7383307, 1748521, 8009340, 1631329, 6289421, 4430637, 8067790, 4108704, 3983219, 1402935, 7130109, 4296289, 3190779, 2544430, 7418037, 8267993, 8318036, 345586, 200210, 4567637, 6241097, 3991427, 7171632, 6773664, 4994580, 6214078, 2585818, 2780826, 7873001, 5368915, 3627118, 1841808, 2089037, 1153908, 76719, 7948167, 3477546, 6874929, 406171, 1500222, 7662488, 7367986, 6550595, 6904771, 5789815, 1384982, 2825359, 5624167, 8253804, 2190915, 6500772, 1250762, 1535099, 6869137, 159577, 456826, 1600644, 3489556, 4767061, 1325706, 2521994, 4302871, 1792226, 5692079, 2482432, 3686699, 2556701, 459446, 7066224, 7551195, 6258634, 7269476, 2246699, 7176255, 1292506, 1135517, 7953767, 6151525, 2687103, 7079287, 1690967, 4915437, 2339794, 471908, 4996965, 3167354, 6393823, 7945547, 5879116, 7244355, 6769323, 5942610, 1229586, 4010547, 6146867, 1952340, 4633305, 1970528, 1400157, 4667160, 4855026, 5835515, 6413332, 7233851, 1979224, 809890, 4945626, 1171142, 5050410, 6619500, 3282636, 2462383, 305524, 1160638, 3417454, 3373132, 775053, 2839405, 5332655, 3737833, 6986220, 7904390, 5473969, 3830427, 5398103, 1267257, 8194029, 5109907, 1204573, 3327482, 5271973, 1320158, 1777361, 5462724, 1223069, 3829071, 7394476, 2826879, 5945015, 4575922, 4145792, 6430065, 5575682, 4574566, 5140808, 500603, 3297810, 888158, 2094713, 5096328, 2888055, 7084835, 2443041, 6362966, 3398406, 5362736, 3845450, 6225608, 5430434, 5315668, 7324321, 6816133, 6128178, 4076601, 4220099, 3368571, 290431, 1234152, 6911327, 4774106, 4284267, 7170841, 7551265, 987276, 6078806, 3042257, 3170047, 2042027, 2837528, 326314, 2058495, 7459760, 1153340, 4328392, 8043159, 338314, 6887926, 1116437, 3644378, 5546993, 190494, 5514068, 642322, 6559208, 4026319, 7928226, 3157279, 7073044, 2448537, 7081300, 8171543, 6897522, 8233115, 1323693, 5237729, 5037301, 4224353, 7288556, 2894702, 8066679, 6198651, 8189481, 4889378, 4223300, 720722, 476767, 3150419, 8072119, 4142954, 457268, 2143940, 5452302, 7932492, 454032, 5472635, 4784935, 5746488, 8119552, 7562931, 7327303, 407967, 5130560, 5548711, 4452061, 4955017, 3274433, 7823426, 168591, 5305231, 7947725, 1908653, 332874, 7506900, 7784571, 6522625, 2177869, 6156769, 285441, 7898754, 3952911, 769120, 4666753, 8215964, 5570646, 2818941, 2734099, 6388949, 3966429, 4931505, 3322933, 4962817, 2427710, 4088045, 5908989, 3887702, 7919340, 374951, 2496004, 7575010, 6057032, 4583311, 3738240, 7277837, 4452082, 7953248, 7094463, 4742723, 3074642, 5183998, 5082060, 7987800, 2124377, 3410505, 5145337, 2127721, 815886, 4899274, 3268115, 7835433, 193770, 6223732, 7454054, 3090279, 6748393, 914530, 4338385, 1174089, 2318147, 1967591, 4066608, 6360043, 2317176, 2235894, 3259656, 5837469, 6280616, 2577273, 3488737, 2089292, 5154271, 2836572, 950939, 6712164, 8120925, 2219476, 6469601, 5714851, 2363031, 1238975, 2888804, 3534051, 3930556, 3077175, 3308921, 2483174, 6938646, 1051446, 3894353, 6201675, 3646488, 5300985, 4510640, 6206544, 6197725, 4429432, 1935392, 7097227, 284068, 413620, 5003254, 6160780, 6257384, 5669300, 5096072, 6346292, 5669951, 4974429, 5812317, 40015, 7129659, 7943119, 1218973, 5976856, 3399944, 5706061, 4908903, 6709211, 5507530, 7491541, 1185413, 6198884, 664902, 7407794, 7219580, 7000082, 6127876, 3221086, 2592676, 4551327, 2735042, 2650310, 2914854, 5396981, 8315072, 1755205, 3496090, 4637472, 1278047, 4019854, 5872648, 6463460, 8228884, 5283241, 8285746, 561663, 1717263, 6996581, 937493, 569126, 3355612, 3888624, 751314, 8129046, 2995310, 7111435, 7653679, 2804122, 818246, 490026, 2532345, 4040621, 7126946, 6400065, 823267, 2653192, 575205, 5949954, 7467500, 3955830, 6139634, 4419272, 609825, 2363371, 1375226, 7616321, 2682550, 7073645, 2525292, 913830, 5284484, 3213265, 278546, 7492045, 3405395, 7850887, 259933, 7315705, 4999598, 6260406, 7967034, 3261819, 7795168, 7069324, 2265359, 4111973, 888371, 2566023, 4780621, 1173116, 3120509, 4581463, 5065177, 3553115, 2259373, 2333198, 7213042, 255063, 7097777, 5147187, 6452941, 3301396, 7242635, 7017340, 5457520, 2268660, 2032526, 227895, 3113125, 1125823, 6372467, 1668269, 5935419, 8247820, 6145620, 4496549, 3339816, 2490560, 7716893, 4154272, 840575, 3195651, 1162358, 167912, 6830473, 343384, 3658352, 1637781, 1955976, 3348787, 6035139, 4984262, 4765821, 7183623, 7030454, 340723, 1626292, 3626545, 1834125, 4600007, 3191301, 982111, 6570868, 5940881, 4660600, 6041494, 4746641, 6532576, 1574520, 1736951, 5284644, 2504481, 3790101, 4337644, 1374539, 5328189, 5677633, 6950031, 7609615, 3950454, 310194, 6078801, 376555, 6856973, 7210505, 4215311, 5451510, 4096279, 1983069, 6635754, 7311162, 7770178, 4483145, 2961805, 1093831, 2680586, 5828065, 479648, 795378, 5021465, 2727360, 3385844, 1187691, 6247182, 7621356, 6568929, 2953483, 6938462, 2034494, 2112047, 8297137, 3075932, 7271297, 6062213, 5710165, 8386746, 6897259, 6193997, 2566540, 310111, 1303597, 8368587, 1045629, 8003572, 526760, 1081993, 7359364, 2066004, 8276705, 2894488, 107856, 5186522, 6370499, 1581710, 1195741, 4439605, 8316926, 988967, 5838453, 2916807, 8028648, 6865201, 6897144, 7172898, 5507933, 6527496, 311869, 708975, 4860000, 793704, 1499272, 2830604, 1404203, 6551063, 2231544, 767639, 4483655, 2510101, 6173449, 4167752, 1811141, 6826138, 1507849, 1982674, 376345, 4668027, 8301347, 3637370, 7739477, 2537991, 6905721, 4471806, 5028201, 637742, 2067583, 6665935, 977770, 1824523, 8214005, 7639276, 6004614, 7154775, 7895733, 8104291, 7053190, 5070150, 521174, 5565476, 2627822, 1452296, 7883819, 5815323, 7704745, 4225794, 6337410, 7290660, 3376792, 5837260, 715780, 2587542, 1498944, 5870687, 509260, 2905059, 3212995, 978845, 1071332, 7589002, 5042961, 5279006, 4384295, 4423591, 5230376, 5684755, 7885928, 3548609, 672255, 7937146, 5203418, 4373588, 38378, 6386271, 3201575, 1610526, 3865230, 1061958, 7333661, 3638382, 5191998, 3743461, 1743587, 5229322, 1841386, 7367899, 519065, 834406, 4282023, 8096703, 2930807, 1811911, 7793251, 3588481, 1466137, 6650272, 8118694, 2673938, 967537, 6016740, 6097774, 2366396, 4356008, 8282850, 3995724, 611502, 4048985, 5784151, 2433674, 5874020, 5474186, 1203031, 4122970, 167415, 623588, 5766847, 3744266, 1049030, 7437456, 7078619, 6234113, 2723088, 5629000, 1390285, 6408478, 505285, 2792843, 5408457, 8254981, 2497407, 2302798, 6800798, 263222, 4016976, 4336559, 1752194, 6084101, 6072751, 4068434, 2144811, 5095641, 8061699, 2775993, 7231488, 2170880, 412224, 5892222, 7333617, 2340044, 3397834, 6102195, 6269352, 4882749, 6552967, 8359348, 1123779, 5505080, 5504828, 5724366, 1967458, 4114652, 4467406, 7780799, 4611268, 4493514, 2368070, 2775909, 7330106, 592408, 7810093, 5629084, 3327370, 5100172, 8110560, 45645, 2033326, 3522244, 2920976, 4447869, 1767232, 8280989, 6620121, 624194, 2254675, 2167372, 3274096, 4338428, 7483684, 3617019, 7218460, 7541292, 4154213, 5114650, 6133565, 1911891, 1318, 1651667, 5840661, 5853855, 7700925, 7282022, 1801241, 2551138, 8278041, 1048190, 8013322, 4066565, 6208098, 6237621, 5737960, 5990095, 3914354, 1065881, 2354428, 6493102, 3410547, 2670958, 7540957, 2263243, 5804160, 3371040, 5831477, 4203909, 2896708, 3445189, 1568611, 5809561, 6636229, 4427451, 2686639, 899497, 3049450, 6116147, 4318191, 7505496, 6938518, 1608477, 3622502, 6141750, 1543152, 5734035, 1211043, 6690694, 5403300, 4270537, 5326987, 2595432, 7172708, 1899663, 1147738, 1430521, 5671898, 7773611, 2519493, 1178652, 4625077, 5075383, 2944985, 2585148, 8214102, 2055283, 4298993, 5239876, 3502520, 6975046, 6057592, 3165117, 6168458, 3763800, 3421193, 6974472, 658962, 6505330, 1961831, 3485804, 5756481, 4608494, 1894809, 5819845, 133956, 4890573, 983744, 4776312, 914324, 5995331, 6422738, 3564737, 4588604, 1667288, 8168042, 4521556, 1982417, 3079392, 2537893, 7946121, 7484634, 6557861, 7582299, 458872, 3908318, 8086293, 706342, 3628681, 7065598, 3514420, 584941, 7855704, 6611016, 5536459, 4717052, 3883437, 2181784, 7277985, 7919056, 2531920, 5315714, 7395871, 7011568, 3412460, 8099460, 6636700, 2160136, 4519158, 8077002, 5607728, 6918050, 3923104, 7724559, 5509692, 2745579, 4481889, 2092273, 7931618, 7418556, 5873073, 6547840, 1127008, 6795210, 8139648, 8205940, 2913982, 4593587, 3885835, 5162778, 4174789, 5081858, 5335292, 2678934, 3812512, 3119881, 2329536, 151844, 951646, 2589239, 3267107, 477281, 3805942, 174400, 2597126, 6272327, 5126435, 3221793, 5807867, 2735629, 5596643, 4756030, 3069701, 6466997, 4230204, 1482220, 736241, 7118156, 6409638, 6435538, 5137886, 62725, 1789817, 7527237, 4195569, 5650605, 6736213, 991639, 727916, 3684852, 4345891, 375157, 4052982, 8232807, 3217561, 174133, 2229075, 7359327, 6135708, 2420073, 6175918, 1726649, 4780898, 2983411, 4209424, 437663, 6615176, 3859759, 7413130, 3915096, 560295, 3091737, 4352011, 7613492, 5656764, 5601588, 1016095, 5512376, 3851399, 4697693, 2421586, 7133391, 3954033, 2918981, 4458901, 3353002, 4556661, 8274913, 6843551, 3588951, 1205804, 2555131, 1561442, 3195343, 6880487, 693664, 7388898, 4351720, 2748229, 976425, 5572756, 6226430, 2289957, 5748567, 3946092, 4046305, 6516893, 8396540, 353452, 5771123, 2631695, 177974, 5315041, 533274, 7460226, 7947821, 5389359, 3937664, 4015495, 5059624, 6535390, 6593856, 5572126, 5543522, 1869603, 8188964, 2299407, 7344113, 8051541, 2471360, 1888100, 6829268, 4368947, 7613071, 762092, 2451650, 3015634, 421707, 4616032, 7313662, 3207212, 1817568, 718839, 8065641, 82262, 2178601, 5105759, 1774201, 3708827, 7779373, 5273231, 2910037, 2041755, 1144927, 1316798, 7625955, 6363238, 6871858, 3791089, 2766170, 5197781, 157050, 3788961, 4009955, 75450, 7127620, 2760594, 1567076, 4696166, 3940319, 432545, 2289253, 1335315, 3019244, 5331527, 5305236, 1816635, 4317154, 7828807, 6129117, 5397411, 4484841, 1077775, 674355, 149482, 6574256, 8261352, 507868, 8255511, 697451, 7214046, 218750, 7069678, 5952899, 7972448, 2603546, 2413090, 7115744, 5481009, 6077734, 3007582, 264222, 6096395, 1500272, 3059070, 5029038, 2671562, 237691, 6953507, 968824, 4332540, 4467637, 6320697, 3972, 1775399, 2972725, 3462514, 3502978, 2023942, 5377306, 4942479, 1721847, 4869211, 5030915, 5345923, 4151445, 2308598, 903145, 4834469, 6018885, 6134076, 2810040, 2084296, 8019193, 2246053, 5872427, 4763944, 6800749, 7714402, 6267765, 4217036, 4634377, 8025549, 1188585, 6073933, 440987, 4060524, 5704375, 2219561, 894087, 1866609, 453984, 6185432, 7506945, 1885976, 3769452, 3641049, 1951098, 6158940, 3424947, 419475, 506665, 1528970, 895337, 2331060, 7327274, 5635671, 5045022, 3411882, 7375821, 8067023, 500835, 3581986, 6680549, 4531828, 1595299, 6973553, 4950070, 5939523, 64503, 5863331, 6150636, 1762506, 3673436, 2541662, 1992100, 2150546, 8364969, 4993111, 2785171, 2769322, 3207541, 946412, 3004946, 5525361, 8202130, 1431440, 7568212, 1720879, 2252566, 5330183, 1214956, 5939545, 965861, 7922106, 2894875, 8352176, 4816104, 376611, 1266753, 6345098, 997291, 1753836, 6841511, 1668062, 5406836, 6651157, 3969814, 8298717, 169391, 3074810, 5550621, 6684114, 6204090, 3270288, 7201589, 7693381, 4260335, 8028382, 8020815, 7345500, 3038166, 4397426, 3219729, 5666045, 4060268, 7573404, 2762178, 2186047, 2041022, 7025866, 317605, 7045489, 8225795, 4595967, 718176, 1126554, 4092037, 3809026, 3372081, 6194277, 692999, 4007567, 1613754, 1059493, 7716711, 3037922, 8291926, 1857019, 3675238, 1379127, 2943865, 4930522, 3686733, 3629313, 7853498, 5774063, 8386286, 180372, 4879722, 1018070, 7619603, 7615172, 7560401, 8015515, 2039821, 2545577, 7585393, 5948592, 7734185, 5859416, 848264, 7795544, 5279069, 4775680, 3557943, 3474471, 1772678, 3239835, 1406511, 8319640, 4417675, 789821, 2366377, 1687941, 3688063, 7957560, 6796318, 5264234, 4481427, 7090428, 2042885, 6099328, 3361268, 8393123, 4232317, 4769105, 5113633, 3576752, 5141860, 7787269, 7832421, 4828241, 367196, 7078558, 152225, 447433, 6906161, 6717052, 2716628, 4321672, 5324446, 435993, 2661757, 11870, 1150270, 4484909, 8222125, 1368093, 3356541, 312129, 7294528, 6860547, 4949529, 3000607, 3784661, 3736529, 2308834, 1266532, 8056564, 2593631, 6413093, 7485516, 8080628, 5811362, 54531, 2192083, 7211174, 7036900, 4884425, 3920084, 3364627, 2634625, 5859631, 2905760, 5027996, 4668464, 7998805, 2324488, 896483, 5094234, 1392640, 3677636, 2109110, 1784620, 6144348, 3665474, 870345, 2131325, 4916655, 8385734, 5770663, 5185189, 1022118, 5989962, 8353976, 3219804, 5478527, 3915945, 6325147, 3310759, 4429564, 6080505, 2353594, 5074975, 6793207, 457832, 381949, 6273668, 2654400, 5492721, 5626630, 3870484, 7220026, 2347886, 95719, 6435240, 3982608, 7918049, 5589833, 6133316, 5171, 4315644, 2272455, 7871167, 3861250, 5005777, 1282920, 533826, 5904510, 4163563, 1900577, 4534509, 314137, 2912272, 1939669, 8186128, 4350612, 1814060, 2464829, 2271677};

int32_t merging_zetas_inv[] = {5743809, 1286859, 6366112, 5755367, 3410874, 565761, 4838745, 5360959, 7102939, 1062426, 3895117, 65160, 1456603, 8334655, 7818486, 821844, 7729527, 1584985, 8126445, 798825, 1829632, 3052666, 726699, 3763962, 793830, 7945228, 1078201, 4929623, 2197388, 5932357, 974719, 525758, 7214765, 3589030, 2983829, 211622, 3220515, 1560003, 7921390, 2563895, 1797363, 3461701, 8100009, 7830420, 3789562, 7598168, 7053336, 4966314, 3988426, 3451311, 4122808, 4353329, 4134276, 7014236, 3460930, 8178965, 2978856, 4852799, 625110, 838375, 5827398, 2773745, 1039987, 5634632, 406233, 1207722, 7259528, 6091045, 3583444, 5360621, 5195604, 3304066, 7827705, 2351980, 135774, 1715262, 6083519, 4909535, 7944276, 314004, 5894591, 3409000, 6560823, 1586412, 7091483, 2024945, 501375, 7305880, 4559235, 7499506, 675651, 1471781, 4386748, 55755, 3470768, 5415803, 2256251, 7779088, 1816215, 677685, 3801741, 2196412, 2114216, 2862856, 1321111, 1939232, 815070, 872108, 2586790, 8403817, 5040367, 3110317, 5451988, 7311049, 5124518, 2458210, 4376879, 6224833, 8118885, 7135647, 3566556, 8124142, 2203008, 1512050, 6725315, 7318064, 7208900, 732926, 2083074, 5592116, 6373528, 6718583, 3531130, 155136, 5073052, 3938143, 4984286, 1288938, 4786385, 7456878, 1307395, 461142, 5495172, 3978601, 1620349, 3930754, 1065131, 6714041, 3449617, 4084609, 7791777, 4113757, 6685839, 1036851, 8317937, 5367326, 220748, 7627574, 7653985, 6871687, 1694530, 6743870, 5358811, 6560268, 3926029, 2532329, 4663261, 4496106, 1345414, 1884794, 126927, 2307913, 3776163, 6676115, 8337065, 5874334, 7371901, 8335086, 8053676, 3252514, 5871500, 152155, 1455398, 7069550, 479162, 466690, 1666771, 3553514, 4721561, 6255744, 453077, 3291767, 2268029, 2725332, 449515, 7035934, 3665768, 1936922, 1841291, 393808, 7959011, 344899, 8140280, 6122519, 364272, 5152430, 673164, 1275810, 7211570, 345133, 8119772, 7204505, 5710763, 454477, 25670, 5450851, 5752573, 1198081, 6841883, 7358254, 5965830, 8298274, 7440080, 5120278, 1765392, 6829837, 3017422, 4863569, 4160525, 1817508, 5512270, 7345253, 5586698, 4164568, 7464454, 3701888, 4964479, 3166322, 5399245, 2274161, 3982109, 3499445, 1058265, 4887363, 6383544, 6163460, 2039124, 2520958, 3238319, 7045447, 7847463, 2844309, 7399034, 4659597, 3949336};
int32_t merging_zetas_inv_radix3[] = {2464829, 2271677, 4350612, 1814060, 1939669, 8186128, 314137, 2912272, 1900577, 4534509, 5904510, 4163563, 1282920, 533826, 3861250, 5005777, 2272455, 7871167, 5171, 4315644, 5589833, 6133316, 3982608, 7918049, 95719, 6435240, 7220026, 2347886, 5626630, 3870484, 2654400, 5492721, 381949, 6273668, 6793207, 457832, 2353594, 5074975, 4429564, 6080505, 6325147, 3310759, 5478527, 3915945, 8353976, 3219804, 1022118, 5989962, 5770663, 5185189, 4916655, 8385734, 870345, 2131325, 6144348, 3665474, 2109110, 1784620, 1392640, 3677636, 896483, 5094234, 7998805, 2324488, 5027996, 4668464, 5859631, 2905760, 3364627, 2634625, 4884425, 3920084, 7211174, 7036900, 54531, 2192083, 8080628, 5811362, 6413093, 7485516, 8056564, 2593631, 2308834, 1266532, 3784661, 3736529, 4949529, 3000607, 7294528, 6860547, 3356541, 312129, 8222125, 1368093, 1150270, 4484909, 2661757, 11870, 5324446, 435993, 2716628, 4321672, 6906161, 6717052, 152225, 447433, 367196, 7078558, 7832421, 4828241, 5141860, 7787269, 5113633, 3576752, 4232317, 4769105, 3361268, 8393123, 2042885, 6099328, 4481427, 7090428, 6796318, 5264234, 3688063, 7957560, 2366377, 1687941, 4417675, 789821, 1406511, 8319640, 1772678, 3239835, 3557943, 3474471, 5279069, 4775680, 848264, 7795544, 7734185, 5859416, 7585393, 5948592, 2039821, 2545577, 7560401, 8015515, 7619603, 7615172, 4879722, 1018070, 8386286, 180372, 7853498, 5774063, 3686733, 3629313, 2943865, 4930522, 3675238, 1379127, 8291926, 1857019, 7716711, 3037922, 1613754, 1059493, 692999, 4007567, 3372081, 6194277, 4092037, 3809026, 718176, 1126554, 8225795, 4595967, 317605, 7045489, 2041022, 7025866, 2762178, 2186047, 4060268, 7573404, 3219729, 5666045, 3038166, 4397426, 8020815, 7345500, 4260335, 8028382, 7201589, 7693381, 6204090, 3270288, 5550621, 6684114, 169391, 3074810, 3969814, 8298717, 5406836, 6651157, 6841511, 1668062, 997291, 1753836, 1266753, 6345098, 4816104, 376611, 2894875, 8352176, 965861, 7922106, 1214956, 5939545, 2252566, 5330183, 7568212, 1720879, 8202130, 1431440, 3004946, 5525361, 3207541, 946412, 2785171, 2769322, 8364969, 4993111, 1992100, 2150546, 3673436, 2541662, 6150636, 1762506, 64503, 5863331, 4950070, 5939523, 1595299, 6973553, 6680549, 4531828, 500835, 3581986, 7375821, 8067023, 5045022, 3411882, 7327274, 5635671, 895337, 2331060, 506665, 1528970, 3424947, 419475, 1951098, 6158940, 3769452, 3641049, 7506945, 1885976, 453984, 6185432, 894087, 1866609, 5704375, 2219561, 440987, 4060524, 1188585, 6073933, 4634377, 8025549, 6267765, 4217036, 6800749, 7714402, 5872427, 4763944, 8019193, 2246053, 2810040, 2084296, 6018885, 6134076, 903145, 4834469, 4151445, 2308598, 5030915, 5345923, 1721847, 4869211, 5377306, 4942479, 3502978, 2023942, 2972725, 3462514, 3972, 1775399, 4467637, 6320697, 968824, 4332540, 237691, 6953507, 5029038, 2671562, 1500272, 3059070, 264222, 6096395, 6077734, 3007582, 7115744, 5481009, 2603546, 2413090, 5952899, 7972448, 218750, 7069678, 697451, 7214046, 507868, 8255511, 6574256, 8261352, 674355, 149482, 4484841, 1077775, 6129117, 5397411, 4317154, 7828807, 5305236, 1816635, 3019244, 5331527, 2289253, 1335315, 3940319, 432545, 1567076, 4696166, 7127620, 2760594, 4009955, 75450, 157050, 3788961, 2766170, 5197781, 6871858, 3791089, 7625955, 6363238, 1144927, 1316798, 2910037, 2041755, 7779373, 5273231, 1774201, 3708827, 2178601, 5105759, 8065641, 82262, 1817568, 718839, 7313662, 3207212, 421707, 4616032, 2451650, 3015634, 7613071, 762092, 6829268, 4368947, 2471360, 1888100, 7344113, 8051541, 8188964, 2299407, 5543522, 1869603, 6593856, 5572126, 5059624, 6535390, 3937664, 4015495, 7947821, 5389359, 533274, 7460226, 177974, 5315041, 5771123, 2631695, 8396540, 353452, 4046305, 6516893, 5748567, 3946092, 6226430, 2289957, 976425, 5572756, 4351720, 2748229, 693664, 7388898, 3195343, 6880487, 2555131, 1561442, 3588951, 1205804, 8274913, 6843551, 3353002, 4556661, 2918981, 4458901, 7133391, 3954033, 4697693, 2421586, 5512376, 3851399, 5601588, 1016095, 7613492, 5656764, 3091737, 4352011, 3915096, 560295, 3859759, 7413130, 437663, 6615176, 2983411, 4209424, 1726649, 4780898, 2420073, 6175918, 7359327, 6135708, 174133, 2229075, 8232807, 3217561, 375157, 4052982, 3684852, 4345891, 991639, 727916, 5650605, 6736213, 7527237, 4195569, 62725, 1789817, 6435538, 5137886, 7118156, 6409638, 1482220, 736241, 6466997, 4230204, 4756030, 3069701, 2735629, 5596643, 3221793, 5807867, 6272327, 5126435, 174400, 2597126, 477281, 3805942, 2589239, 3267107, 151844, 951646, 3119881, 2329536, 2678934, 3812512, 5081858, 5335292, 5162778, 4174789, 4593587, 3885835, 8205940, 2913982, 6795210, 8139648, 6547840, 1127008, 7418556, 5873073, 2092273, 7931618, 2745579, 4481889, 7724559, 5509692, 6918050, 3923104, 8077002, 5607728, 2160136, 4519158, 8099460, 6636700, 7011568, 3412460, 5315714, 7395871, 7919056, 2531920, 2181784, 7277985, 4717052, 3883437, 6611016, 5536459, 584941, 7855704, 7065598, 3514420, 706342, 3628681, 3908318, 8086293, 7582299, 458872, 7484634, 6557861, 2537893, 7946121, 1982417, 3079392, 8168042, 4521556, 4588604, 1667288, 6422738, 3564737, 914324, 5995331, 983744, 4776312, 133956, 4890573, 1894809, 5819845, 5756481, 4608494, 1961831, 3485804, 658962, 6505330, 3421193, 6974472, 6168458, 3763800, 6057592, 3165117, 3502520, 6975046, 4298993, 5239876, 8214102, 2055283, 2944985, 2585148, 4625077, 5075383, 2519493, 1178652, 5671898, 7773611, 1147738, 1430521, 7172708, 1899663, 5326987, 2595432, 5403300, 4270537, 1211043, 6690694, 1543152, 5734035, 3622502, 6141750, 6938518, 1608477, 4318191, 7505496, 3049450, 6116147, 2686639, 899497, 6636229, 4427451, 1568611, 5809561, 2896708, 3445189, 5831477, 4203909, 5804160, 3371040, 7540957, 2263243, 3410547, 2670958, 2354428, 6493102, 3914354, 1065881, 5737960, 5990095, 6208098, 6237621, 8013322, 4066565, 8278041, 1048190, 1801241, 2551138, 7700925, 7282022, 5840661, 5853855, 1318, 1651667, 6133565, 1911891, 4154213, 5114650, 7218460, 7541292, 7483684, 3617019, 3274096, 4338428, 2254675, 2167372, 6620121, 624194, 1767232, 8280989, 2920976, 4447869, 2033326, 3522244, 8110560, 45645, 3327370, 5100172, 7810093, 5629084, 7330106, 592408, 2368070, 2775909, 4611268, 4493514, 4467406, 7780799, 1967458, 4114652, 5504828, 5724366, 1123779, 5505080, 6552967, 8359348, 6269352, 4882749, 3397834, 6102195, 7333617, 2340044, 412224, 5892222, 7231488, 2170880, 8061699, 2775993, 2144811, 5095641, 6072751, 4068434, 1752194, 6084101, 4016976, 4336559, 6800798, 263222, 2497407, 2302798, 5408457, 8254981, 505285, 2792843, 1390285, 6408478, 2723088, 5629000, 7078619, 6234113, 1049030, 7437456, 5766847, 3744266, 167415, 623588, 1203031, 4122970, 5874020, 5474186, 5784151, 2433674, 611502, 4048985, 8282850, 3995724, 2366396, 4356008, 6016740, 6097774, 2673938, 967537, 6650272, 8118694, 3588481, 1466137, 1811911, 7793251, 8096703, 2930807, 834406, 4282023, 7367899, 519065, 5229322, 1841386, 3743461, 1743587, 3638382, 5191998, 1061958, 7333661, 1610526, 3865230, 6386271, 3201575, 4373588, 38378, 7937146, 5203418, 3548609, 672255, 5684755, 7885928, 4423591, 5230376, 5279006, 4384295, 7589002, 5042961, 978845, 1071332, 2905059, 3212995, 5870687, 509260, 2587542, 1498944, 5837260, 715780, 7290660, 3376792, 4225794, 6337410, 5815323, 7704745, 1452296, 7883819, 5565476, 2627822, 5070150, 521174, 8104291, 7053190, 7154775, 7895733, 7639276, 6004614, 1824523, 8214005, 6665935, 977770, 637742, 2067583, 4471806, 5028201, 2537991, 6905721, 3637370, 7739477, 4668027, 8301347, 1982674, 376345, 6826138, 1507849, 4167752, 1811141, 2510101, 6173449, 767639, 4483655, 6551063, 2231544, 2830604, 1404203, 793704, 1499272, 708975, 4860000, 6527496, 311869, 7172898, 5507933, 6865201, 6897144, 2916807, 8028648, 988967, 5838453, 4439605, 8316926, 1581710, 1195741, 5186522, 6370499, 2894488, 107856, 2066004, 8276705, 1081993, 7359364, 8003572, 526760, 8368587, 1045629, 310111, 1303597, 6193997, 2566540, 8386746, 6897259, 6062213, 5710165, 3075932, 7271297, 2112047, 8297137, 6938462, 2034494, 6568929, 2953483, 6247182, 7621356, 3385844, 1187691, 5021465, 2727360, 479648, 795378, 2680586, 5828065, 2961805, 1093831, 7770178, 4483145, 6635754, 7311162, 4096279, 1983069, 4215311, 5451510, 6856973, 7210505, 6078801, 376555, 3950454, 310194, 6950031, 7609615, 5328189, 5677633, 4337644, 1374539, 2504481, 3790101, 1736951, 5284644, 6532576, 1574520, 6041494, 4746641, 5940881, 4660600, 982111, 6570868, 4600007, 3191301, 3626545, 1834125, 340723, 1626292, 7183623, 7030454, 4984262, 4765821, 3348787, 6035139, 1637781, 1955976, 343384, 3658352, 167912, 6830473, 3195651, 1162358, 4154272, 840575, 2490560, 7716893, 4496549, 3339816, 8247820, 6145620, 1668269, 5935419, 1125823, 6372467, 227895, 3113125, 2268660, 2032526, 7017340, 5457520, 3301396, 7242635, 5147187, 6452941, 255063, 7097777, 2333198, 7213042, 3553115, 2259373, 4581463, 5065177, 1173116, 3120509, 2566023, 4780621, 4111973, 888371, 7069324, 2265359, 3261819, 7795168, 6260406, 7967034, 7315705, 4999598, 7850887, 259933, 7492045, 3405395, 3213265, 278546, 913830, 5284484, 7073645, 2525292, 7616321, 2682550, 2363371, 1375226, 4419272, 609825, 3955830, 6139634, 5949954, 7467500, 2653192, 575205, 6400065, 823267, 4040621, 7126946, 490026, 2532345, 2804122, 818246, 7111435, 7653679, 8129046, 2995310, 3888624, 751314, 569126, 3355612, 6996581, 937493, 561663, 1717263, 5283241, 8285746, 6463460, 8228884, 4019854, 5872648, 4637472, 1278047, 1755205, 3496090, 5396981, 8315072, 2650310, 2914854, 4551327, 2735042, 3221086, 2592676, 7000082, 6127876, 7407794, 7219580, 6198884, 664902, 7491541, 1185413, 6709211, 5507530, 5706061, 4908903, 5976856, 3399944, 7943119, 1218973, 40015, 7129659, 4974429, 5812317, 6346292, 5669951, 5669300, 5096072, 6160780, 6257384, 413620, 5003254, 7097227, 284068, 4429432, 1935392, 6206544, 6197725, 5300985, 4510640, 6201675, 3646488, 1051446, 3894353, 2483174, 6938646, 3077175, 3308921, 3534051, 3930556, 1238975, 2888804, 5714851, 2363031, 2219476, 6469601, 6712164, 8120925, 2836572, 950939, 2089292, 5154271, 2577273, 3488737, 5837469, 6280616, 2235894, 3259656, 6360043, 2317176, 1967591, 4066608, 1174089, 2318147, 914530, 4338385, 3090279, 6748393, 6223732, 7454054, 7835433, 193770, 4899274, 3268115, 2127721, 815886, 3410505, 5145337, 7987800, 2124377, 5183998, 5082060, 4742723, 3074642, 7953248, 7094463, 7277837, 4452082, 4583311, 3738240, 7575010, 6057032, 374951, 2496004, 3887702, 7919340, 4088045, 5908989, 4962817, 2427710, 4931505, 3322933, 6388949, 3966429, 2818941, 2734099, 8215964, 5570646, 769120, 4666753, 7898754, 3952911, 6156769, 285441, 6522625, 2177869, 7506900, 7784571, 1908653, 332874, 5305231, 7947725, 7823426, 168591, 4955017, 3274433, 5548711, 4452061, 407967, 5130560, 7562931, 7327303, 5746488, 8119552, 5472635, 4784935, 7932492, 454032, 2143940, 5452302, 4142954, 457268, 3150419, 8072119, 720722, 476767, 4889378, 4223300, 6198651, 8189481, 2894702, 8066679, 4224353, 7288556, 5237729, 5037301, 8233115, 1323693, 8171543, 6897522, 2448537, 7081300, 3157279, 7073044, 4026319, 7928226, 642322, 6559208, 190494, 5514068, 3644378, 5546993, 6887926, 1116437, 8043159, 338314, 1153340, 4328392, 2058495, 7459760, 2837528, 326314, 3170047, 2042027, 6078806, 3042257, 7551265, 987276, 4284267, 7170841, 6911327, 4774106, 290431, 1234152, 4220099, 3368571, 6128178, 4076601, 7324321, 6816133, 5430434, 5315668, 3845450, 6225608, 3398406, 5362736, 2443041, 6362966, 2888055, 7084835, 2094713, 5096328, 3297810, 888158, 5140808, 500603, 5575682, 4574566, 4145792, 6430065, 5945015, 4575922, 7394476, 2826879, 1223069, 3829071, 1777361, 5462724, 5271973, 1320158, 1204573, 3327482, 8194029, 5109907, 5398103, 1267257, 5473969, 3830427, 6986220, 7904390, 5332655, 3737833, 775053, 2839405, 3417454, 3373132, 305524, 1160638, 3282636, 2462383, 5050410, 6619500, 4945626, 1171142, 1979224, 809890, 6413332, 7233851, 4855026, 5835515, 1400157, 4667160, 4633305, 1970528, 6146867, 1952340, 1229586, 4010547, 6769323, 5942610, 5879116, 7244355, 6393823, 7945547, 4996965, 3167354, 2339794, 471908, 1690967, 4915437, 2687103, 7079287, 7953767, 6151525, 1292506, 1135517, 2246699, 7176255, 6258634, 7269476, 7066224, 7551195, 2556701, 459446, 2482432, 3686699, 1792226, 5692079, 2521994, 4302871, 4767061, 1325706, 1600644, 3489556, 159577, 456826, 1535099, 6869137, 6500772, 1250762, 8253804, 2190915, 2825359, 5624167, 5789815, 1384982, 6550595, 6904771, 7662488, 7367986, 406171, 1500222, 3477546, 6874929, 76719, 7948167, 2089037, 1153908, 3627118, 1841808, 7873001, 5368915, 2585818, 2780826, 4994580, 6214078, 7171632, 6773664, 6241097, 3991427, 200210, 4567637, 8318036, 345586, 7418037, 8267993, 3190779, 2544430, 7130109, 4296289, 3983219, 1402935, 8067790, 4108704, 6289421, 4430637, 8009340, 1631329, 7383307, 1748521, 1016086, 913101, 4676572, 8287716, 2960884, 137000, 5398894, 8059407, 2600386, 6722545, 5065261, 5880107, 5561365, 1318705, 6985765, 6340538, 2423427, 4803834, 7429373, 3686115, 2339278, 1334881, 5085005, 1123889, 1204287, 7070112, 6048652, 6122539, 6920201, 1682448, 5042866, 7464427, 4296225, 2003667, 64479, 7214988, 1114166, 3601159, 4164473, 2064455, 6357485, 936471, 2167149, 4706406, 4218374, 6521372, 4933087, 361211, 4569434, 7825265, 5739839, 74855, 861518, 6158913, 6603656, 7576844, 3088345, 2246080, 5296878, 5941644, 3559563, 7468522, 7046327, 7938055, 5316226, 1011326, 98416, 2460326, 1220102, 579728, 4099298, 8043782, 2695898, 390337, 4415594, 43185, 2199724, 5477152, 6449055, 1257674, 1061927, 2642775, 7862474, 1730507, 1061026, 1515132, 4810963, 8171341, 2386297, 6889861, 4089620, 8119927, 4544227, 8014656, 1205793, 1024022, 256852, 2120844, 8101442, 1558317, 2868962, 5762218, 7006888, 7147319, 4822348, 1556014, 3601184, 8165137, 3718955, 1291499, 523805, 738616, 7542783, 6945729, 4617399, 7553490, 3798532, 4002748, 1019926, 5739205, 775088, 4402245, 3408152, 8237228, 6272386, 6848979, 5915709, 6477821, 7595908, 704511, 3706138, 3762892, 4882442, 1459264, 432750, 7666377, 6184712, 7852813, 6780739, 3028286, 1584807, 6203244, 5777692, 6210202, 4030085, 6270213, 3556943, 1807289, 1308532, 7378744, 4377683, 8388148, 4884289, 1026249, 2508166, 4068464, 7961863, 552180, 4233387, 6193357, 8304009, 1255109, 182827, 2002037, 2560193, 2134780, 3017256, 2194791, 3190534, 170608, 7195223, 5425338, 5734707, 489340, 6717711, 2610921, 7596703, 7968938, 4695563, 1837824, 1275616, 8029437, 7736376, 1552256, 2672259, 375556, 5655169, 53285, 2952259, 8234385, 5869587, 4163177, 8218140, 2008432, 1151372, 5049782, 6904101, 436055, 6347835, 5794072, 2490863, 7251227, 4875941, 712751, 1845114, 6395159, 1176741, 3722818, 2030009, 5499146, 8247009, 43705, 923239, 5602465, 7561898, 455315, 874428, 2802528, 1020684, 3489312, 2734127, 1153766, 5899177, 4178133, 7754677, 7294932, 4975695, 6315216, 6792039, 2905847, 5471251, 4682175, 1968406, 1707967, 7329055, 8044247, 8108525, 4647167, 5449879, 4288762, 7564399, 3062647, 2234481, 6062626, 7456006, 7173753, 1910632, 3249057, 4760469, 1231240, 595299, 7709814, 1721544, 6697026, 1957313, 7537819, 4020, 7770593, 3734452, 6813007, 8403952, 5342346, 2928390, 4116231, 122290, 2973376, 1118784, 7032873, 6679782, 4244195, 7314433, 753361, 1487418, 3192952, 6205316, 854167, 5147067, 7889000, 7290967, 2254012, 2645777, 515993, 3567907, 7437147, 8240463, 5431617, 1615887, 3007373, 7445307, 3827543, 7950325, 6516880, 286150, 5212041, 6348454, 7651632, 1682318, 7814418, 2434996, 7272087, 4594806, 7356075, 577673, 5266195, 3887307, 8069514, 198719, 8360147, 1458408, 927381, 5597631, 7201097, 316758, 7477612, 3947129, 7020596, 7833721, 590575, 3918781, 4062299, 2134627, 7769572, 6137798, 8199468, 5801151, 335479, 3998155, 3138798, 6080344, 6085359, 4020654, 5330058, 6303576, 7915425, 2278413, 693033, 3929613, 1487097, 4324123, 3146260, 1535266, 5959433, 1065441, 4378748, 2986542, 2445560, 654376, 997529, 2350266, 2319634, 1502833, 5071781, 2051694, 826626, 82329, 2884498, 4775139, 6917896, 3496258, 7711960, 688220, 2387596, 4402060, 4550163, 1954392, 7709678, 4816015, 6844641, 2685500, 1583099, 6698800, 7499523, 308157, 4687868, 4840800, 6073363, 4724656, 3717125, 6030946, 887784, 1059673, 6017397, 4245121, 4513011, 6448849, 1482126, 8143183, 833038, 3542387, 6821894, 3877418, 1560352, 2966254, 5719616, 7967488, 8077987, 3409280, 2756715, 4928233, 4729155, 1731939, 4555215, 4616282, 5500491, 4575684, 5782587, 1037511, 5942850, 1356060, 2622406, 7016262, 7311930, 1906899, 2685377, 6894862, 2267012, 7245500, 2815114, 6300791, 5455581, 1385379, 3849778, 2084479, 3675838, 1982341, 6053228, 7227670, 1643945, 233076, 7195237, 7149337, 3007404, 1630666, 4263175, 3435061, 4948878, 6565165, 2368989, 2675293, 790345, 6236896, 6036004, 3958285, 3053419, 3427919, 2351765, 3206900, 3797749, 4080321, 2597113, 3173353, 4012934, 1195165, 4141818, 1693494, 5397589, 6392363, 1261986, 4184278, 1768178, 7483526, 1687276, 7669702, 2708046, 965528, 7764035, 6826739, 27987, 4968594, 7601153, 1845714, 7923061, 1004253, 803840, 7341160, 1046318, 1289222, 7143007, 561790, 2226114, 6124052, 1289973, 2490308, 964338, 220591, 640958, 6623753, 5696947, 4307141, 2795100, 7729595, 6677606, 2516353, 7641739, 7060028, 5326383, 37923, 5186657, 1207855, 5700774, 1978525, 8095411, 4221177, 1629460, 5480542, 309582, 5417020, 4423403, 5969652, 5609893, 4189694, 6955843, 4815956, 90881, 4579567, 6368024, 5928489, 3218336, 1918808, 3078610, 4831078, 5967779, 3682426, 593495, 5661133, 7655428, 7301990, 3087154, 4883958, 5120096, 2836279, 1960853, 2887591, 2295982, 1761601, 4128440, 3581890, 6109011, 7405893, 4370531, 3776738, 2437214, 8103639, 7215594, 5987846, 7928632, 1708002, 2889477, 3053345, 3284897, 433795, 5317839, 6713958, 3876720, 5164872, 4515800, 1661017, 7235603, 2338364, 2776396, 197274, 5894153, 3043161, 6546235, 6258932, 4608563, 7068951, 745421, 8200884, 3796430, 8379093, 4724763, 6883480, 4528273, 1525979, 3521817, 6838166, 2017962, 7454905, 719370, 1076883, 2510840, 6533880, 5628597, 8265246, 5131280, 7603213, 1681972, 2965391, 7517826, 7205603, 2837987, 926563, 6266243, 1573250, 365669, 2124750, 8128402, 7100721, 239145, 4698559, 276591, 3841362, 5379076, 2803881, 3273713, 3283020, 3077132, 56522, 5496949, 1307768, 1405381, 7123335, 2138750, 5187630, 5567006};
#endif

void ntt(int32_t * Out, int32_t * A){

	if(Out!=A){
		memcpy(Out,A,sizeof(int32_t)*N);
	}

#if NIMS_TRI_NTT_MODE == 1
	//asm_ntt_1(Out, merging_zetas);
	asm_ntt_1(Out, merging_zetas);
	asm_ntt_1_radix3(Out, merging_zetas_radix3);
#endif

#if NIMS_TRI_NTT_MODE == 3
	asm_ntt_3(Out, merging_zetas);
#endif

#if NIMS_TRI_NTT_MODE == 5
	asm_ntt_5(Out, merging_zetas);
	asm_ntt_5_radix3(Out, merging_zetas_radix3);

#endif


}
void invntt_tomont(int32_t * Out, int32_t * A){

	if(Out!=A){
		memcpy(Out,A,sizeof(int32_t)*N);
	}


#if NIMS_TRI_NTT_MODE == 1
	asm_intt_1_radix3(Out, merging_zetas_inv_radix3);
	asm_intt_1(Out, merging_zetas_inv);
#endif
#if NIMS_TRI_NTT_MODE == 3
	asm_intt_3(Out, merging_zetas_inv);
#endif
#if NIMS_TRI_NTT_MODE == 5
	asm_intt_5_radix3(Out, merging_zetas_inv_radix3);
	asm_intt_5(Out, merging_zetas_inv);
#endif
}



void pointwise_mul(int32_t* C, int32_t* A, int32_t* B){
	for(int i=0;i<N;i++){
		C[i] = montgomery_reduce((int64_t)A[i] * B[i]);
	}
}

void base_mul(int32_t* C, int32_t* A, int32_t* B, int32_t zeta){ //2차식 곱셈
	C[0]=montgomery_reduce((int64_t)A[2]*B[1]);
	C[0]+=montgomery_reduce((int64_t)A[1]*B[2]);
	C[0]=montgomery_reduce((int64_t)C[0]*zeta);
	C[0]+=montgomery_reduce((int64_t)A[0]*B[0]);

	C[1]  = montgomery_reduce((int64_t)A[2]* B[2]);
	C[1]  = montgomery_reduce((int64_t)C[1]* zeta);
	C[1] += montgomery_reduce((int64_t)A[0]* B[1]);
	C[1] += montgomery_reduce((int64_t)A[1]* B[0]);

	C[2]  = montgomery_reduce((int64_t)A[2]* B[0]);
	C[2] += montgomery_reduce((int64_t)A[1]* B[1]);
	C[2] += montgomery_reduce((int64_t)A[0]* B[2]);
}



void poly_base_mul(poly* c, poly* a, poly* b){
	#if NIMS_TRI_NTT_MODE==1
	asm_pointwise_montgomery_1(c->coeffs, a->coeffs, b->coeffs);

	#elif NIMS_TRI_NTT_MODE==3 //2차식 곱셈(poly)
	asm_pointwise_montgomery_3(c->coeffs, a->coeffs, b->coeffs, zetas+255);


	#elif NIMS_TRI_NTT_MODE==5//pointwise 곱셈
	asm_pointwise_montgomery_5(c->coeffs, a->coeffs, b->coeffs);

	#endif

}



void reduce_modQ(int32_t * a){
  for(int i=0;i<N;i++){ 
	a[i]=a[i] % Q;
  }
}


void poly_mul_schoolbook(poly* res, poly* a, poly* b)
{
	// Polynomial multiplication using the schoolbook method, c[x] = a[x]*b[x] 
	// SECURITY NOTE: TO BE USED FOR TESTING ONLY.  
	uint32_t i, j;

	int32_t c[N << 1];
	int32_t t0;
	for (i = 0; i < (N << 1); i++) c[i] = 0;

	for (i = 0; i < N; i++)
	{
		for (j = 0; j < N; j++)
		{
			t0 = ((int64_t)(Q+a->coeffs[i]) * (Q+b->coeffs[j])) % Q;
			c[i + j] = (c[i + j] + t0) % Q;
		}
	}

	for (i = N + (N >> 1) - 1; i < 2 * N - 1; i++) {
		c[i - (N>>1)] = (c[i - (N>>1)] + c[i]) % Q;
		c[i - N] = (Q + c[i - N] - c[i]) % Q;
	}


	for (i = N; i < N + (N >> 1) - 1; i++)
	{
		c[i - (N>>1)] = (c[i - (N>>1)] + c[i]) % Q;
		c[i - N] = (Q + c[i - N] - c[i]) % Q;
	}

	for (i = 0; i < N; i++)
		res->coeffs[i] = c[i];	
}

void poly_caddq(poly *a) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		a->coeffs[i] = caddq(a->coeffs[i]);

	DBENCH_STOP(*tred);
}

void poly_add(poly *c, const poly *a, const poly *b) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		c->coeffs[i] = a->coeffs[i] + b->coeffs[i];

	DBENCH_STOP(*tadd);
}

void poly_modadd(poly *c, poly *a, poly *b) {
	unsigned int i;

	for (i = 0; i < N; ++i)
		c->coeffs[i] = mod_add(a->coeffs[i], b->coeffs[i]);

}

void poly_sub(poly *c, poly *a, poly *b) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		c->coeffs[i] = a->coeffs[i] - b->coeffs[i];

	DBENCH_STOP(*tadd);
}

void poly_modsub(poly *c, poly *a, poly *b) {
	unsigned int i;
	for (i = 0; i < N; ++i)
		c->coeffs[i] = mod_sub(a->coeffs[i], b->coeffs[i]);
}

void poly_shiftl(poly *a) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		a->coeffs[i] <<= D;

	DBENCH_STOP(*tmul);
}

void poly_power2round(poly *a1, poly *a0, const poly *a) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		a1->coeffs[i] = power2round(&a0->coeffs[i], a->coeffs[i]);

	DBENCH_STOP(*tround);
}

void poly_decompose(poly *a1, poly *a0, const poly *a) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		a1->coeffs[i] = decompose(&a0->coeffs[i], a->coeffs[i]);

	DBENCH_STOP(*tround);
}

unsigned int poly_make_hint(poly *h, const poly *a0, const poly *a1) {
	unsigned int i, s = 0;
	DBENCH_START();

	for (i = 0; i < N; ++i) {
		h->coeffs[i] = make_hint(a0->coeffs[i], a1->coeffs[i]);
		s += h->coeffs[i];
	}

	DBENCH_STOP(*tround);
	return s;
}

void poly_use_hint(poly *b, const poly *a, const poly *h) {
	unsigned int i;
	DBENCH_START();

	for (i = 0; i < N; ++i)
		b->coeffs[i] = use_hint(a->coeffs[i], h->coeffs[i]);

	DBENCH_STOP(*tround);
}

int poly_chknorm(poly *a, int32_t B) {
	unsigned int i;
	int32_t t;
	DBENCH_START();

	if (B > (Q - 1) / 8)
		return 1;

	for (i = 0; i < N; ++i) {
		/* Absolute value */
		t = a->coeffs[i] >> 31;
		t = a->coeffs[i] - (t & 2 * a->coeffs[i]);

		if (t >= B) {
			DBENCH_STOP(*tsample);
			return 1;
		}
	}
	DBENCH_STOP(*tsample);
	return 0;
}

static unsigned int rej_uniform(int32_t *a,
	unsigned int len,
	const uint8_t *buf,
	unsigned int buflen)
{
	unsigned int ctr, pos;
	uint32_t t;
	DBENCH_START();

	ctr = pos = 0;
	while (ctr < len && pos + 3 <= buflen) {
		t = buf[pos++];
		t |= (uint32_t)buf[pos++] << 8;
		t |= (uint32_t)buf[pos++] << 16;
		t &= 0xFFFFFF;
		if (t < Q && t != 0)
			a[ctr++] = t;
	}

	DBENCH_STOP(*tsample);
	return ctr;
}

//#define POLY_UNIFORM_NBLOCKS ((768 + STREAM128_BLOCKBYTES - 1)/STREAM128_BLOCKBYTES)
#define POLY_UNIFORM_NBLOCKS ((N*3 + STREAM128_BLOCKBYTES - 1)/STREAM128_BLOCKBYTES)
void poly_uniform(poly *a,
	const uint8_t seed[SEEDBYTES],
	uint16_t nonce)
{
	unsigned int i, ctr, off;
	unsigned int buflen = POLY_UNIFORM_NBLOCKS * STREAM128_BLOCKBYTES;
	uint8_t buf[POLY_UNIFORM_NBLOCKS*STREAM128_BLOCKBYTES + 2];
	stream128_state state;



	stream128_init(&state, seed, nonce);
	stream128_squeezeblocks(buf, POLY_UNIFORM_NBLOCKS, &state);

	ctr = rej_uniform(a->coeffs, N, buf, buflen);

	while (ctr < N) {
		off = buflen % 3;
		for (i = 0; i < off; ++i)
			buf[i] = buf[buflen - off + i];

		stream128_squeezeblocks(buf + off, 1, &state);
		buflen = STREAM128_BLOCKBYTES + off;
		ctr += rej_uniform(a->coeffs + ctr, N - ctr, buf, buflen);
	}

}

static unsigned int rej_eta(int32_t *a,
	unsigned int len,
	const uint8_t *buf,
	unsigned int buflen)
{
	unsigned int ctr, pos;
	uint32_t t0, t1;
	uint32_t t2, t3;
	DBENCH_START();

	ctr = pos = 0;
	while (ctr < len && pos < buflen) {

#if ETA == 2
		t0 = buf[pos] & 0x0F;
		t1 = buf[pos++] >> 4;
		if (t0 < 15) {
			t0 = t0 - (13 * t0 >> 8) * 5;
			a[ctr++] = 2 - t0;
		}
		if (t1 < 15 && ctr < len) {
			t1 = t1 - (13 * t1 >> 8) * 5;
			a[ctr++] = 2 - t1;
		}
#elif ETA == 1
		t0 = buf[pos] & 0x03;
		t1 = (buf[pos] >> 2) & 0x03;
		t2 = (buf[pos] >> 4) & 0x03;
		t3 = buf[pos++] >> 6;
		if (t0 < 3) {
			a[ctr++] = 1 - t0;
		}
		if (t1 < 3 && ctr < len) {
			a[ctr++] = 1 - t0;
		}
		if (t2 < 3 && ctr < len) {
			a[ctr++] = 1 - t0;
		}
		if (t3 < 3 && ctr < len) {
			a[ctr++] = 1 - t0;
		}
#endif
	}

	DBENCH_STOP(*tsample);
	return ctr;
}

#define POLY_UNIFORM_ETA_NBLOCKS ((136 + STREAM256_BLOCKBYTES - 1)/STREAM256_BLOCKBYTES)
void poly_uniform_eta(poly *a,
	const uint8_t seed[CRHBYTES],
	uint16_t nonce)
{
	unsigned int ctr;
	unsigned int buflen = POLY_UNIFORM_ETA_NBLOCKS * STREAM256_BLOCKBYTES;
	uint8_t buf[POLY_UNIFORM_ETA_NBLOCKS*STREAM256_BLOCKBYTES];
	stream256_state state;

	stream256_init(&state, seed, nonce);
	stream256_squeezeblocks(buf, POLY_UNIFORM_ETA_NBLOCKS, &state);

	ctr = rej_eta(a->coeffs, N, buf, buflen);

	while (ctr < N) {
		stream256_squeezeblocks(buf, 1, &state);
		ctr += rej_eta(a->coeffs + ctr, N - ctr, buf, STREAM256_BLOCKBYTES);
	}
}

#define POLY_UNIFORM_GAMMA1_NBLOCKS ((POLYZ_PACKEDBYTES + STREAM256_BLOCKBYTES - 1)/STREAM256_BLOCKBYTES)

void poly_uniform_gamma1(poly *a,
	const uint8_t seed[CRHBYTES],
	uint16_t nonce)
{
	uint8_t buf[POLY_UNIFORM_GAMMA1_NBLOCKS*STREAM256_BLOCKBYTES];
	stream256_state state;

	stream256_init(&state, seed, nonce);
	stream256_squeezeblocks(buf, POLY_UNIFORM_GAMMA1_NBLOCKS, &state);
	polyz_unpack(a, buf);
}
//sample in ball
void poly_challenge(poly *c, const uint8_t seed[SEEDBYTES]) {
	unsigned int i, b, pos;
	uint32_t signs;
	uint8_t buf[SHAKE256_RATE];
	shake256incctx state;

	shake256_inc_init(&state);
	shake256_inc_absorb(&state, seed, SEEDBYTES);
	shake256_inc_finalize(&state);
	shake256_inc_squeezeblocks(buf, 1, &state);

	signs = 0;
	for (i = 0; i < 4; ++i)
		signs |= (uint32_t)buf[i] << 8 * i;
	pos = 4;

	for (i = 0; i < N; ++i)
		c->coeffs[i] = 0;
#if (N==2304)
	for (i = N - TAU; i < N; ++i) {
		do {
			if (pos >= SHAKE256_RATE) {
				shake256_squeezeblocks(buf, 1, &state);
				pos = 0;
			}

			b = (uint32_t)buf[pos++] << 4;
			b |= (buf[pos++] & 0xF);
		} while (b > i);

		c->coeffs[i] = c->coeffs[b];
		c->coeffs[b] = 1 - 2 * (signs & 1);
		signs >>= 1;
	}
#else
	for (i = N - TAU; i < N; ++i) {
		do {
			if (pos >= SHAKE256_RATE) {
				shake256_squeezeblocks(buf, 1, &state);
				pos = 0;
			}

			b = (uint32_t)buf[pos++] << 3;
			b |= (buf[pos++] & 0x7);
		} while (b > i);

		c->coeffs[i] = c->coeffs[b];
		c->coeffs[b] = 1 - 2 * (signs & 1);
		signs >>= 1;
	}
#endif
}
/*************************************************
* Name:        poly_reduce
*
* Description: Inplace reduction of all coefficients of polynomial to
*              representative in [-6283009,6283007](딜리시움).
*
* Arguments:   - poly *a: pointer to input/output polynomial
**************************************************/
void poly_reduce(poly *a) {
  unsigned int i;
  DBENCH_START();

  for(i = 0; i < N; ++i)
    a->coeffs[i] = reduce32(a->coeffs[i]);
  //asm_reduce32(a->coeffs);

  DBENCH_STOP(*tred);
}
